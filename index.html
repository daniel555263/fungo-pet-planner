<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FunGo 宠物旅行规划器 - 信任增强版</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
    }
    
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", sans-serif; 
      background: #f8f9fb;
      min-height: 100vh;
      color: #1d1d1f;
      line-height: 1.4;
    }
    
    @keyframes spin { 
      to { transform: rotate(360deg); } 
    }
    
    @keyframes fadeInUp { 
      from { opacity: 0; transform: translateY(30px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    
    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes shimmer {
      0% { background-position: -468px 0; }
      100% { background-position: 468px 0; }
    }
    
    .spin { animation: spin 1s linear infinite; }
    .fade-in { animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
    .slide-in { animation: slideInLeft 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
    .pulse { animation: pulse 2s infinite; }
    .shimmer {
      background: linear-gradient(to right, #f6f7f8 0%, #edeef1 20%, #f6f7f8 40%, #f6f7f8 100%);
      background-size: 800px 104px;
      animation: shimmer 1s linear infinite;
    }
    
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 3px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    .trust-badge {
      background: linear-gradient(135deg, rgba(48, 209, 88, 0.1), rgba(52, 199, 89, 0.05));
      border: 1px solid rgba(48, 209, 88, 0.3);
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 10px;
      font-weight: 600;
      color: #30d158;
      display: inline-flex;
      align-items: center;
      gap: 3px;
    }

    .verification-indicator {
      width: 12px;
      height: 12px;
      background: linear-gradient(135deg, #30d158, #34c759);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 8px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback } = React;

    // 获取当前时段
    const getCurrentTimeSlot = () => {
      const hour = new Date().getHours();
      if (hour >= 6 && hour < 9) return { slot: 'morning', label: '早晨', icon: '🌅', activity: '晨练遛狗' };
      if (hour >= 9 && hour < 12) return { slot: 'forenoon', label: '上午', icon: '☀️', activity: '户外活动' };
      if (hour >= 12 && hour < 14) return { slot: 'noon', label: '中午', icon: '🌞', activity: '休闲时光' };
      if (hour >= 14 && hour < 17) return { slot: 'afternoon', label: '下午', icon: '🌤️', activity: '探索游玩' };
      if (hour >= 17 && hour < 19) return { slot: 'evening', label: '傍晚', icon: '🌆', activity: '散步时间' };
      if (hour >= 19 && hour < 22) return { slot: 'night', label: '夜晚', icon: '🌃', activity: '夜游体验' };
      return { slot: 'late', label: '深夜', icon: '🌙', activity: '安静休息' };
    };

    // 增强的数据配置
    const CONFIG = {
      cities: {
        major: [
          { name: '北京', districts: ['朝阳区', '海淀区', '西城区', '东城区'], weather: '☀️', temp: '24°C' },
          { name: '上海', districts: ['浦东新区', '黄浦区', '静安区', '徐汇区'], weather: '⛅', temp: '26°C' },
          { name: '广州', districts: ['天河区', '越秀区', '海珠区', '荔湾区'], weather: '🌦️', temp: '29°C' },
          { name: '深圳', districts: ['南山区', '福田区', '罗湖区', '宝安区'], weather: '☀️', temp: '28°C' },
          { name: '杭州', districts: ['西湖区', '拱墅区', '江干区', '下城区'], weather: '🌦️', temp: '22°C' },
          { name: '成都', districts: ['锦江区', '青羊区', '金牛区', '武侯区'], weather: '☁️', temp: '20°C' }
        ]
      },
      interests: [
        { id: 'beach', label: '玩水嬉戏', icon: '🏖️' },
        { id: 'run', label: '狗狗奔跑', icon: '🏃' },
        { id: 'cafe', label: '喝下午茶', icon: '☕' },
        { id: 'park', label: '公园漫步', icon: '🌳' },
        { id: 'photo', label: '拍照打卡', icon: '📸' },
        { id: 'food', label: '美食探店', icon: '🍽️' },
        { id: 'mountain', label: '登山徒步', icon: '🏔️' },
        { id: 'lake', label: '湖边休闲', icon: '🏞️' }
      ],
      durations: [
        { value: '2', label: '2天1夜', desc: '周末短途' },
        { value: '3', label: '3天2夜', desc: '小长假' },
        { value: '5', label: '5天4夜', desc: '深度游' },
        { value: '7', label: '7天6夜', desc: '度假游' }
      ],
      dataSources: {
        external: [
          { name: '小红书', logo: '🌺', weight: 30, freshness: 95, trustScore: 4.8, sampleSize: '12万+' },
          { name: '大众点评', logo: '🍽️', weight: 25, freshness: 88, trustScore: 4.6, sampleSize: '8万+' },
          { name: '美团', logo: '🛍️', weight: 20, freshness: 92, trustScore: 4.7, sampleSize: '15万+' }
        ],
        internal: [
          { name: 'FunGo踩点', logo: '👥', weight: 15, freshness: 98, trustScore: 4.9, sampleSize: '专业团队' },
          { name: '用户评价', logo: '⭐', weight: 10, freshness: 90, trustScore: 4.5, sampleSize: '5万+' }
        ]
      },
      // 新增：信任度相关配置
      trustIndicators: {
        realTimeVerification: {
          enabled: true,
          interval: 300000, // 5分钟更新一次
          lastCheck: null
        },
        expertVerification: {
          team: [
            { name: '李晓萌', role: '宠物行为专家', cert: '国际宠物行为师认证', years: 8 },
            { name: '张明华', role: '旅游规划师', cert: 'CTA旅游顾问认证', years: 12 },
            { name: '王雅琪', role: '宠物医师', cert: '执业兽医师', years: 6 }
          ]
        },
        userFeedback: {
          totalUsers: 158642,
          satisfaction: 96.8,
          monthlyActive: 45230
        }
      },
      recommendReasons: {
        timeMatch: ['适合当前时段', '正值活跃时间', '现在去正合适'],
        preference: ['符合您的兴趣偏好', '根据您的选择推荐', '为您量身定制'],
        petFriendly: ['宠物超级友好', '毛孩子们的天堂', '专为宠物设计'],
        popular: ['最近很受欢迎', '用户好评如潮', '热门推荐地点'],
        distance: ['距离适中', '就在附近', '步行可达'],
        weather: ['适合当前天气', '天气条件完美', '户外体验佳'],
        verified: ['专家实地验证', '团队亲测推荐', '权威认证场所']
      },
      mockPlaces: {
        '深圳-南山区': [
          { 
            id: 1, name: '深圳湾公园', type: 'park', distance: 1.2, rating: 4.8, petFriendly: 5, 
            time: '全天', features: ['宠物专区', '海滨步道'], aiScore: 94,
            dataSources: ['小红书', 'FunGo踩点', '用户评价'], popularity: 'high',
            lastUpdated: '2分钟前', userFeedback: { likes: 1247, dislikes: 23 }, 
            staffVerified: true, realTimeStatus: 'open', crowdLevel: 'moderate',
            expertReview: { reviewer: '李晓萌', date: '2024-08-15', score: 9.2 },
            safetyChecks: { lastInspection: '2024-08-18', issues: 0, certified: true }
          },
          { 
            id: 2, name: 'MUJI咖啡', type: 'cafe', distance: 0.8, rating: 4.6, petFriendly: 4, 
            time: '10:00-22:00', features: ['宠物友好', '下午茶'], aiScore: 87,
            dataSources: ['大众点评', '小红书'], popularity: 'medium',
            lastUpdated: '5分钟前', userFeedback: { likes: 892, dislikes: 45 }, 
            staffVerified: false, realTimeStatus: 'open', crowdLevel: 'low',
            businessLicense: 'verified', healthRating: 'A级'
          },
          { 
            id: 3, name: '欢乐海岸', type: 'food', distance: 2.1, rating: 4.7, petFriendly: 4, 
            time: '10:00-22:00', features: ['户外座位', '美食街'], aiScore: 91,
            dataSources: ['美团', '大众点评', 'FunGo踩点'], popularity: 'high',
            lastUpdated: '1分钟前', userFeedback: { likes: 2156, dislikes: 67 }, 
            staffVerified: true, realTimeStatus: 'open', crowdLevel: 'high',
            expertReview: { reviewer: '张明华', date: '2024-08-16', score: 8.9 }
          }
        ],
        '北京-朝阳区': [
          { 
            id: 11, name: '朝阳公园', type: 'park', distance: 1.5, rating: 4.7, petFriendly: 5, 
            time: '全天', features: ['大草坪', '宠物训练区'], aiScore: 89,
            dataSources: ['大众点评', 'FunGo踩点'], popularity: 'high',
            lastUpdated: '3分钟前', userFeedback: { likes: 1876, dislikes: 34 }, 
            staffVerified: true, realTimeStatus: 'open', crowdLevel: 'moderate'
          }
        ]
      },
      mockHotels: [
        { 
          id: 'h1', name: '深圳湾宠物友好酒店', price: 688, rating: 4.8, petFee: 100, 
          features: ['宠物SPA', '专属房间', '24h服务'], image: '🏨',
          license: 'verified', insurance: '全覆盖', staffTrained: true
        },
        { 
          id: 'h2', name: '希尔顿欢朋酒店', price: 528, rating: 4.6, petFee: 80, 
          features: ['宠物床垫', '遛狗区域', '宠物餐具'], image: '🏢',
          license: 'verified', insurance: '标准覆盖', staffTrained: true
        },
        { 
          id: 'h3', name: '民宿·毛孩子之家', price: 398, rating: 4.9, petFee: 0, 
          features: ['独栋别墅', '私人花园', '宠物游泳池'], image: '🏡',
          license: 'verified', hostVerified: true, superhost: true
        }
      ]
    };

    const App = () => {
      // 状态管理
      const [page, setPage] = useState('planning');
      const [tripType, setTripType] = useState('local');
      const [selectedCity, setSelectedCity] = useState('深圳');
      const [selectedDistrict, setSelectedDistrict] = useState('南山区');
      const [duration, setDuration] = useState('');
      const [pets, setPets] = useState([{ id: 1, name: '旺财', type: '金毛', emoji: '🐕', weight: '25kg' }]);
      const [preferences, setPreferences] = useState([]);
      const [savedPlans, setSavedPlans] = useState([]);
      const [currentPlan, setCurrentPlan] = useState(null);
      const [showAddPet, setShowAddPet] = useState(false);
      const [showCitySelect, setShowCitySelect] = useState(false);
      const [showMapView, setShowMapView] = useState(false);
      const [showTrustDetails, setShowTrustDetails] = useState(false);
      const [newPet, setNewPet] = useState({ name: '', type: '', weight: '' });
      const [loading, setLoading] = useState(false);
      const [animationClass, setAnimationClass] = useState('');
      const [aiAnalyzing, setAiAnalyzing] = useState(false);
      const [lastAnalysisTime, setLastAnalysisTime] = useState(null);
      const [realTimeData, setRealTimeData] = useState({ lastUpdate: new Date(), isLive: true });

      const currentTimeSlot = getCurrentTimeSlot();

      useEffect(() => {
        setAnimationClass('fade-in');
        setLastAnalysisTime(new Date());
        
        // 模拟实时数据更新
        const interval = setInterval(() => {
          setRealTimeData({ lastUpdate: new Date(), isLive: true });
        }, 30000);
        
        return () => clearInterval(interval);
      }, []);

      // 计算属性
      const currentCityData = useMemo(() => 
        CONFIG.cities.major.find(city => city.name === selectedCity) || CONFIG.cities.major[3], 
        [selectedCity]
      );

      const isFormValid = useMemo(() => 
        selectedCity && tripType && pets.length > 0 && (tripType === 'local' || duration), 
        [selectedCity, tripType, pets.length, duration]
      );

      // 生成智能推荐理由
      const generateRecommendReason = useCallback((place, index) => {
        const reasons = [];
        const { recommendReasons } = CONFIG;
        
        if (index === 0) {
          reasons.push(recommendReasons.timeMatch[Math.floor(Math.random() * recommendReasons.timeMatch.length)]);
        }
        
        if (preferences.length > 0) {
          reasons.push(recommendReasons.preference[Math.floor(Math.random() * recommendReasons.preference.length)]);
        }
        
        if (place.petFriendly >= 4) {
          reasons.push(recommendReasons.petFriendly[Math.floor(Math.random() * recommendReasons.petFriendly.length)]);
        }
        
        if (place.staffVerified) {
          reasons.push(recommendReasons.verified[Math.floor(Math.random() * recommendReasons.verified.length)]);
        }
        
        if (place.aiScore >= 90) {
          reasons.push(recommendReasons.popular[Math.floor(Math.random() * recommendReasons.popular.length)]);
        }
        
        if (place.distance <= 2) {
          reasons.push(recommendReasons.distance[Math.floor(Math.random() * recommendReasons.distance.length)]);
        }
        
        return reasons.slice(0, 3);
      }, [preferences]);

      // 智能重新分析
      const triggerAiAnalysis = useCallback(() => {
        setAiAnalyzing(true);
        setTimeout(() => {
          setAiAnalyzing(false);
          setLastAnalysisTime(new Date());
        }, 2000);
      }, []);

      // 获取推荐方案
      const getLocalPlans = useCallback(() => {
        const places = CONFIG.mockPlaces[`${selectedCity}-${selectedDistrict}`] || CONFIG.mockPlaces['深圳-南山区'];
        
        let filteredPlaces = [...places];
        
        if (preferences.length > 0) {
          const interestMap = {
            '玩水嬉戏': ['beach', 'lake'],
            '狗狗奔跑': ['park', 'mountain'],
            '喝下午茶': ['cafe'],
            '公园漫步': ['park'],
            '拍照打卡': ['park', 'beach', 'mountain', 'photo'],
            '美食探店': ['food'],
            '登山徒步': ['mountain'],
            '湖边休闲': ['lake']
          };
          
          filteredPlaces = filteredPlaces.filter(place => {
            return preferences.some(pref => {
              const types = interestMap[pref] || [];
              return types.includes(place.type);
            });
          });
        }
        
        filteredPlaces.sort((a, b) => a.distance - b.distance);
        
        return filteredPlaces.slice(0, 3).map((place, index) => ({
          id: `local-${index}`,
          place,
          title: place.name,
          subtitle: `距离 ${place.distance}km · ${place.time}`,
          type: 'local',
          features: place.features,
          rating: place.rating,
          petFriendly: place.petFriendly,
          timeRecommend: index === 0 ? currentTimeSlot.activity : null,
          aiScore: place.aiScore,
          dataSources: place.dataSources,
          lastUpdated: place.lastUpdated,
          userFeedback: place.userFeedback,
          staffVerified: place.staffVerified,
          recommendReasons: generateRecommendReason(place, index),
          realTimeStatus: place.realTimeStatus,
          crowdLevel: place.crowdLevel,
          expertReview: place.expertReview,
          safetyChecks: place.safetyChecks
        }));
      }, [selectedCity, selectedDistrict, preferences, currentTimeSlot, generateRecommendReason]);

      const getTravelPlans = useCallback(() => {
        const hotels = CONFIG.mockHotels;
        const places = CONFIG.mockPlaces[`${selectedCity}-${selectedDistrict}`] || CONFIG.mockPlaces['深圳-南山区'];
        
        return hotels.slice(0, 2).map((hotel, index) => ({
          id: `travel-${index}`,
          hotel,
          title: `${duration}天${parseInt(duration) - 1}夜 · ${hotel.name}`,
          subtitle: `¥${hotel.price}/晚 · 宠物费¥${hotel.petFee}`,
          type: 'travel',
          places: places.slice(0, 3),
          totalPrice: hotel.price * (parseInt(duration) - 1) + hotel.petFee,
          features: hotel.features,
          rating: hotel.rating
        }));
      }, [selectedCity, selectedDistrict, duration]);

      // 事件处理
      const handleTripTypeChange = (type) => {
        setTripType(type);
        if (type === 'local') {
          setDuration('');
        }
      };

      const handleAddPet = () => {
        if (newPet.name && newPet.type && newPet.weight) {
          setPets(prev => [...prev, { ...newPet, id: Date.now(), emoji: '🐕' }]);
          setNewPet({ name: '', type: '', weight: '' });
          setShowAddPet(false);
        }
      };

      const handleRemovePet = (id) => {
        if (pets.length > 1) {
          setPets(prev => prev.filter(p => p.id !== id));
        }
      };

      const handleToggleInterest = (interest) => {
        setPreferences(prev => 
          prev.includes(interest) 
            ? prev.filter(p => p !== interest)
            : [...prev, interest]
        );
      };

      const handleCitySelect = (city, district) => {
        setSelectedCity(city);
        setSelectedDistrict(district);
        setShowCitySelect(false);
      };

      const handleSavePlan = (plan) => {
        setSavedPlans(prev => {
          const exists = prev.find(p => p.id === plan.id);
          if (exists) {
            return prev.filter(p => p.id !== plan.id);
          } else {
            return [...prev, { ...plan, savedAt: new Date().toISOString() }];
          }
        });
      };

      const generatePlans = () => {
        if (!isFormValid) return;
        setLoading(true);
        setTimeout(() => {
          setLoading(false);
          setPage('plans');
        }, 1000);
      };

      // 样式
      const styles = {
        container: { background: '#f8f9fb', minHeight: '100vh', paddingBottom: '100px' },
        header: { 
          background: 'rgba(255, 255, 255, 0.95)', 
          backdropFilter: 'saturate(180%) blur(20px)',
          padding: '12px 20px', 
          borderBottom: '0.5px solid rgba(0,0,0,0.05)',
          position: 'sticky', 
          top: 0, 
          zIndex: 100
        },
        logo: { fontSize: '24px', fontWeight: '700', textAlign: 'center', letterSpacing: '-0.5px' },
        content: { padding: '20px 20px 0', maxWidth: '600px', margin: '0 auto' },
        section: { marginBottom: '28px' },
        sectionTitle: {
          fontSize: '20px', fontWeight: '600', color: '#1d1d1f',
          marginBottom: '14px', letterSpacing: '-0.3px'
        },
        button: { 
          padding: '14px 20px', background: '#007aff', color: 'white', 
          border: 'none', borderRadius: '10px', fontSize: '16px', 
          fontWeight: '600', width: '100%', cursor: 'pointer', fontFamily: 'inherit'
        },
        buttonSecondary: { background: '#f2f2f7', color: '#007aff' },
        grid2: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' },
        grid3: { display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '10px' },
        modal: { 
          position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, 
          background: 'rgba(0,0,0,0.4)', display: 'flex', alignItems: 'center',
          justifyContent: 'center', padding: '20px', zIndex: 1000
        },
        modalContent: { 
          background: 'white', borderRadius: '16px', padding: '24px 20px', 
          width: '100%', maxWidth: '380px', maxHeight: '80vh', overflowY: 'auto'
        },
        input: { 
          width: '100%', padding: '14px 16px', border: '0.5px solid #d1d1d6', 
          borderRadius: '10px', fontSize: '16px', marginBottom: '12px', 
          outline: 'none', fontFamily: 'inherit', background: 'white'
        },
        bottomBar: { 
          position: 'fixed', bottom: 0, left: 0, right: 0, padding: '16px 20px', 
          background: 'rgba(255, 255, 255, 0.95)', borderTop: '0.5px solid rgba(0,0,0,0.05)'
        }
      };

      // 组件
      const SelectableCard = ({ selected, onClick, children, size = 'medium', disabled = false }) => (
        <div 
          onClick={disabled ? undefined : onClick}
          style={{
            padding: size === 'large' ? '18px' : size === 'small' ? '14px' : '16px',
            borderRadius: '10px', cursor: disabled ? 'not-allowed' : 'pointer',
            border: '0.5px solid', borderColor: selected ? '#007aff' : 'rgba(0,0,0,0.08)',
            background: selected ? '#007aff' : 'white', color: selected ? 'white' : '#1d1d1f',
            opacity: disabled ? 0.5 : 1
          }}
        >
          {children}
        </div>
      );

      const LocationCard = () => (
        <div 
          onClick={() => setShowCitySelect(true)}
          style={{
            background: 'white', borderRadius: '14px', padding: '18px', marginBottom: '20px',
            border: '0.5px solid rgba(0,0,0,0.04)', cursor: 'pointer'
          }}
        >
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '14px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
              <div style={{ fontSize: '18px' }}>📍</div>
              <div>
                <div style={{ fontSize: '17px', fontWeight: '600', color: '#1d1d1f' }}>
                  {selectedCity} · {selectedDistrict}
                </div>
                <div style={{ fontSize: '13px', color: '#86868b', marginTop: '2px' }}>
                  {currentTimeSlot.icon} {currentTimeSlot.label} · 当前位置
                </div>
              </div>
            </div>
            <div style={{ fontSize: '16px', color: '#007aff' }}>›</div>
          </div>
          <div style={{ 
            padding: '10px 14px', background: 'rgba(0, 122, 255, 0.08)', borderRadius: '8px',
            display: 'flex', alignItems: 'center', gap: '10px', fontSize: '14px'
          }}>
            <span>{currentCityData.weather}</span>
            <span style={{ fontWeight: '500', color: '#007aff' }}>{currentCityData.temp}</span>
            <span style={{ color: '#86868b' }}>适宜出行</span>
            <div style={{ marginLeft: 'auto', display: 'flex', alignItems: 'center', gap: '4px' }}>
              <div className="verification-indicator">✓</div>
              <span style={{ fontSize: '12px', color: '#30d158' }}>实时验证</span>
            </div>
          </div>
        </div>
      );

      const TrustIndicatorBar = () => (
        <div style={{
          background: 'white',
          borderRadius: '12px',
          padding: '16px',
          marginBottom: '20px',
          border: '0.5px solid rgba(0,0,0,0.04)',
          cursor: 'pointer'
        }}
        onClick={() => setShowTrustDetails(true)}
        >
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '12px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
              <div style={{ fontSize: '16px' }}>🛡️</div>
              <div>
                <div style={{ fontSize: '16px', fontWeight: '600', color: '#1d1d1f' }}>
                  信任保障体系
                </div>
                <div style={{ fontSize: '12px', color: '#86868b' }}>
                  多重验证 · 实时监控 · 专家认证
                </div>
              </div>
            </div>
            <div style={{ fontSize: '14px', color: '#007aff' }}>查看详情 ›</div>
          </div>
          
          <div style={{ display: 'flex', gap: '8px', marginBottom: '10px' }}>
            <div className="trust-badge">
              <span>🔴</span> 实时监控
            </div>
            <div className="trust-badge">
              <span>👥</span> 专家验证
            </div>
            <div className="trust-badge">
              <span>📊</span> 数据透明
            </div>
          </div>
          
          <div style={{ 
            background: 'rgba(48, 209, 88, 0.1)', 
            borderRadius: '6px', 
            padding: '8px 12px',
            fontSize: '12px',
            color: '#30d158',
            fontWeight: '500'
          }}>
            🌟 用户满意度 {CONFIG.trustIndicators.userFeedback.satisfaction}% · 月活跃用户 {CONFIG.trustIndicators.userFeedback.monthlyActive.toLocaleString()}
          </div>
        </div>
      );

      const DataSourceBadges = ({ dataSources, lastUpdated, realTimeStatus }) => {
        const sourceConfig = CONFIG.dataSources;
        const allSources = [...sourceConfig.external, ...sourceConfig.internal];
        
        return (
          <div style={{ marginBottom: '10px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '6px' }}>
              <span style={{ fontSize: '11px', color: '#86868b' }}>数据来源:</span>
              {dataSources.map(sourceName => {
                const source = allSources.find(s => s.name === sourceName);
                return source ? (
                  <div key={sourceName} style={{
                    display: 'flex', alignItems: 'center', gap: '3px',
                    background: 'rgba(0, 122, 255, 0.08)', padding: '2px 6px',
                    borderRadius: '10px', fontSize: '10px', color: '#007aff'
                  }}>
                    <span>{source.logo}</span>
                    <span>{source.name}</span>
                    <span style={{ 
                      fontSize: '8px', 
                      background: '#30d158', 
                      color: 'white', 
                      padding: '1px 3px', 
                      borderRadius: '2px',
                      marginLeft: '2px'
                    }}>
                      {source.trustScore}
                    </span>
                  </div>
                ) : null;
              })}
            </div>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '10px', color: '#86868b' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }}>
                <span style={{ 
                  width: '6px', 
                  height: '6px', 
                  borderRadius: '50%', 
                  background: realTimeStatus === 'open' ? '#30d158' : '#ff3b30' 
                }}></span>
                📄 更新于 {lastUpdated}
              </div>
              {realTimeStatus && (
                <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }}>
                  <span style={{ 
                    width: '6px', 
                    height: '6px', 
                    borderRadius: '50%', 
                    background: '#30d158',
                    animation: 'pulse 2s infinite'
                  }}></span>
                  实时状态: {realTimeStatus === 'open' ? '正常营业' : '暂停营业'}
                </div>
              )}
            </div>
          </div>
        );
      };

      const AiScoreDisplay = ({ aiScore, userFeedback, staffVerified, expertReview, safetyChecks }) => {
        const getScoreColor = (score) => {
          if (score >= 90) return '#30d158';
          if (score >= 80) return '#ff9500';
          return '#ff3b30';
        };

        const getScoreLevel = (score) => {
          if (score >= 90) return '极力推荐';
          if (score >= 80) return '值得一去';
          return '一般推荐';
        };

        return (
          <div style={{
            background: 'linear-gradient(135deg, rgba(0, 122, 255, 0.05), rgba(0, 122, 255, 0.1))',
            borderRadius: '8px', padding: '10px', marginBottom: '12px',
            border: '0.5px solid rgba(0, 122, 255, 0.2)'
          }}>
            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '6px' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                <span style={{ fontSize: '12px', fontWeight: '600', color: '#007aff' }}>🤖 FunGo AI评分</span>
                {staffVerified && (
                  <span className="trust-badge">
                    ✓ 员工认证
                  </span>
                )}
                {expertReview && (
                  <span className="trust-badge">
                    👨‍⚕️ 专家验证
                  </span>
                )}
              </div>
              <div style={{ fontSize: '18px', fontWeight: '700', color: getScoreColor(aiScore) }}>
                {aiScore}
              </div>
            </div>
            
            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '8px' }}>
              <span style={{ fontSize: '11px', color: getScoreColor(aiScore), fontWeight: '500' }}>
                {getScoreLevel(aiScore)}
              </span>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '10px', color: '#86868b' }}>
                <span>👍 {userFeedback.likes}</span>
                <span>👎 {userFeedback.dislikes}</span>
                <span style={{ color: '#30d158' }}>
                  {Math.round((userFeedback.likes / (userFeedback.likes + userFeedback.dislikes)) * 100)}% 好评
                </span>
              </div>
            </div>

            {expertReview && (
              <div style={{ 
                background: 'rgba(48, 209, 88, 0.1)', 
                borderRadius: '4px', 
                padding: '6px 8px',
                fontSize: '10px',
                color: '#30d158',
                marginBottom: '6px'
              }}>
                👨‍⚕️ 专家 {expertReview.reviewer} 评分: {expertReview.score}/10 ({expertReview.date})
              </div>
            )}

            {safetyChecks && (
              <div style={{ fontSize: '9px', color: '#86868b', lineHeight: '1.3' }}>
                🛡️ 安全检查: {safetyChecks.lastInspection} · 
                {safetyChecks.issues === 0 ? ' 无安全隐患' : ` ${safetyChecks.issues}个隐患`} · 
                {safetyChecks.certified ? ' 安全认证' : ' 待认证'}
              </div>
            )}
          </div>
        );
      };

      const RecommendReasons = ({ reasons }) => {
        if (!reasons || reasons.length === 0) return null;
        
        return (
          <div style={{ marginBottom: '10px' }}>
            <div style={{ fontSize: '12px', color: '#86868b', marginBottom: '4px' }}>
              💡 推荐理由:
            </div>
            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>
              {reasons.map((reason, index) => (
                <span key={index} style={{
                  background: 'rgba(48, 209, 88, 0.1)', color: '#30d158',
                  padding: '2px 6px', borderRadius: '4px', fontSize: '10px',
                  fontWeight: '500', border: '0.5px solid rgba(48, 209, 88, 0.3)'
                }}>
                  {reason}
                </span>
              ))}
            </div>
          </div>
        );
      };

      const RealTimeStatusIndicator = ({ status, crowdLevel, lastUpdate }) => (
        <div style={{
          background: status === 'open' ? 'rgba(48, 209, 88, 0.1)' : 'rgba(255, 59, 48, 0.1)',
          border: `0.5px solid ${status === 'open' ? 'rgba(48, 209, 88, 0.3)' : 'rgba(255, 59, 48, 0.3)'}`,
          borderRadius: '6px',
          padding: '6px 8px',
          marginBottom: '8px',
          fontSize: '11px'
        }}>
          <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
            <div style={{
              width: '6px',
              height: '6px',
              borderRadius: '50%',
              background: status === 'open' ? '#30d158' : '#ff3b30',
              animation: 'pulse 2s infinite'
            }}></div>
            <span style={{ fontWeight: '600', color: status === 'open' ? '#30d158' : '#ff3b30' }}>
              {status === 'open' ? '🟢 正常营业' : '🔴 暂停营业'}
            </span>
            <span style={{ color: '#86868b' }}>·</span>
            <span style={{ color: '#86868b' }}>
              人流: {crowdLevel === 'low' ? '较少' : crowdLevel === 'moderate' ? '适中' : '较多'}
            </span>
          </div>
          <div style={{ fontSize: '9px', color: '#86868b', marginTop: '2px' }}>
            实时数据更新于 {lastUpdate || '刚刚'}
          </div>
        </div>
      );

      const LocalPlanCard = ({ plan, onSave, isSaved, onPreview }) => (
        <div style={{
          background: 'white',
          borderRadius: '14px',
          overflow: 'hidden',
          marginBottom: '14px',
          border: '0.5px solid rgba(0,0,0,0.04)',
          boxShadow: '0 2px 8px rgba(0,0,0,0.04)'
        }}>
          {plan.timeRecommend && (
            <div style={{
              background: 'linear-gradient(135deg, #30d158, #34c759)',
              color: 'white',
              padding: '8px 14px',
              fontSize: '12px',
              fontWeight: '600',
              display: 'flex',
              alignItems: 'center',
              gap: '6px'
            }}>
              {currentTimeSlot.icon} {plan.timeRecommend}推荐
            </div>
          )}
          
          <div style={{ padding: '16px' }}>
            <div style={{ marginBottom: '12px' }}>
              <h3 style={{ fontSize: '17px', fontWeight: '600', color: '#1d1d1f', marginBottom: '4px' }}>
                {plan.title}
              </h3>
              <p style={{ fontSize: '13px', color: '#86868b' }}>
                {plan.subtitle}
              </p>
            </div>

            <RealTimeStatusIndicator 
              status={plan.realTimeStatus} 
              crowdLevel={plan.crowdLevel}
              lastUpdate={plan.lastUpdated}
            />

            <DataSourceBadges 
              dataSources={plan.dataSources} 
              lastUpdated={plan.lastUpdated}
              realTimeStatus={plan.realTimeStatus}
            />
            
            <AiScoreDisplay 
              aiScore={plan.aiScore} 
              userFeedback={plan.userFeedback} 
              staffVerified={plan.staffVerified}
              expertReview={plan.expertReview}
              safetyChecks={plan.safetyChecks}
            />
            
            <RecommendReasons reasons={plan.recommendReasons} />
            
            <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '10px' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                <span style={{ fontSize: '13px', color: '#86868b' }}>用户评分</span>
                <span style={{ fontSize: '14px', fontWeight: '500', color: '#1d1d1f' }}>{plan.rating}</span>
                <span style={{ fontSize: '12px', color: '#ffa726' }}>⭐</span>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                <span style={{ fontSize: '13px', color: '#86868b' }}>宠物友好</span>
                <div style={{ display: 'flex', gap: '1px' }}>
                  {[1,2,3,4,5].map(i => (
                    <span key={i} style={{ 
                      fontSize: '10px', 
                      color: i <= plan.petFriendly ? '#007aff' : '#e0e0e0' 
                    }}>
                      🐾
                    </span>
                  ))}
                </div>
              </div>
            </div>
            
            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px', marginBottom: '12px' }}>
              {plan.features?.map((feature, idx) => (
                <span key={idx} style={{
                  background: 'rgba(0, 122, 255, 0.08)',
                  color: '#007aff',
                  padding: '3px 8px',
                  borderRadius: '4px',
                  fontSize: '11px',
                  fontWeight: '500'
                }}>
                  {feature}
                </span>
              ))}
            </div>
            
            <div style={{ display: 'flex', gap: '8px' }}>
              <button
                onClick={() => onPreview(plan)}
                style={{
                  flex: 1,
                  padding: '10px',
                  background: '#f2f2f7',
                  color: '#007aff',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                预览详情
              </button>
              <button
                onClick={() => onSave(plan)}
                style={{
                  padding: '10px 16px',
                  background: isSaved ? '#30d158' : '#007aff',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                {isSaved ? '✓ 已收藏' : '收藏'}
              </button>
            </div>
          </div>
        </div>
      );

      const TrustDetailsModal = () => (
        <div style={styles.modal} onClick={(e) => e.target === e.currentTarget && setShowTrustDetails(false)}>
          <div style={{...styles.modalContent, maxWidth: '500px'}}>
            <div style={{ 
              display: 'flex', 
              justifyContent: 'space-between', 
              alignItems: 'center', 
              marginBottom: '20px',
              paddingBottom: '12px',
              borderBottom: '0.5px solid rgba(0,0,0,0.05)'
            }}>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1d1d1f' }}>信任保障体系</h3>
              <button 
                onClick={() => setShowTrustDetails(false)} 
                style={{ 
                  background: 'none', 
                  border: 'none', 
                  fontSize: '24px', 
                  color: '#86868b',
                  cursor: 'pointer'
                }}
              >
                ×
              </button>
            </div>
            
            <div style={{ maxHeight: '70vh', overflowY: 'auto' }}>
              {/* 实时监控 */}
              <div style={{ marginBottom: '20px' }}>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  🔴 实时监控系统
                </h4>
                <div style={{ fontSize: '14px', color: '#86868b', lineHeight: '1.5', marginBottom: '8px' }}>
                  24/7 监控所有推荐场所的营业状态、人流密度、天气影响等实时信息
                </div>
                <div style={{ background: '#f8f9fb', borderRadius: '6px', padding: '8px', fontSize: '12px' }}>
                  <div>• 营业状态: 每5分钟更新</div>
                  <div>• 人流监控: 基于多平台数据实时分析</div>
                  <div>• 天气预警: 自动提醒不适宜户外活动</div>
                  <div>• 安全提醒: 发现问题立即推送警告</div>
                </div>
              </div>

              {/* 专家团队 */}
              <div style={{ marginBottom: '20px' }}>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  👥 专家验证团队
                </h4>
                <div style={{ fontSize: '14px', color: '#86868b', lineHeight: '1.5', marginBottom: '8px' }}>
                  由专业宠物专家、旅游规划师实地验证每个推荐场所
                </div>
                {CONFIG.trustIndicators.expertVerification.team.map((expert, index) => (
                  <div key={index} style={{ 
                    background: '#f8f9fb', 
                    borderRadius: '6px', 
                    padding: '8px', 
                    marginBottom: '6px',
                    fontSize: '12px'
                  }}>
                    <div style={{ fontWeight: '600', marginBottom: '2px' }}>
                      {expert.name} - {expert.role}
                    </div>
                    <div style={{ color: '#86868b' }}>
                      {expert.cert} · {expert.years}年经验
                    </div>
                  </div>
                ))}
              </div>

              {/* 数据透明 */}
              <div style={{ marginBottom: '20px' }}>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  📊 数据来源透明
                </h4>
                <div style={{ fontSize: '14px', color: '#86868b', lineHeight: '1.5', marginBottom: '8px' }}>
                  清楚展示每个推荐的数据来源、更新时间、可信度评分
                </div>
                <div style={{ display: 'grid', gap: '6px' }}>
                  {[...CONFIG.dataSources.external, ...CONFIG.dataSources.internal].map((source, index) => (
                    <div key={index} style={{ 
                      background: '#f8f9fb', 
                      borderRadius: '6px', 
                      padding: '8px',
                      fontSize: '12px',
                      display: 'flex',
                      justifyContent: 'space-between',
                      alignItems: 'center'
                    }}>
                      <div>
                        <span>{source.logo}</span> {source.name} 
                        <span style={{ color: '#86868b', marginLeft: '6px' }}>
                          ({source.sampleSize})
                        </span>
                      </div>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                        <span style={{ color: '#30d158', fontWeight: '600' }}>
                          {source.trustScore}
                        </span>
                        <span style={{ fontSize: '10px', color: '#86868b' }}>
                          权重{source.weight}%
                        </span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* 用户反馈 */}
              <div style={{ marginBottom: '20px' }}>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  ⭐ 用户满意度
                </h4>
                <div style={{
                  background: 'linear-gradient(135deg, rgba(48, 209, 88, 0.1), rgba(52, 199, 89, 0.05))',
                  borderRadius: '8px',
                  padding: '12px',
                  textAlign: 'center'
                }}>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: '#30d158', marginBottom: '4px' }}>
                    {CONFIG.trustIndicators.userFeedback.satisfaction}%
                  </div>
                  <div style={{ fontSize: '14px', color: '#1d1d1f', fontWeight: '500' }}>
                    用户满意度
                  </div>
                  <div style={{ fontSize: '12px', color: '#86868b', marginTop: '6px' }}>
                    基于 {CONFIG.trustIndicators.userFeedback.totalUsers.toLocaleString()} 用户反馈
                  </div>
                </div>
              </div>

              {/* 安全保障 */}
              <div>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  🛡️ 安全保障承诺
                </h4>
                <div style={{ fontSize: '13px', color: '#86868b', lineHeight: '1.5' }}>
                  <div>• 所有推荐场所均经过安全检查认证</div>
                  <div>• 宠物友好度由专业兽医团队评估</div>
                  <div>• 提供24小时客服支持和应急联系</div>
                  <div>• 发现问题立即下架并补偿用户损失</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );

      const TravelPlanCard = ({ plan, onSave, isSaved, onPreview, onBookHotel }) => (
        <div style={{
          background: 'white',
          borderRadius: '14px',
          overflow: 'hidden',
          marginBottom: '14px',
          border: '0.5px solid rgba(0,0,0,0.04)',
          boxShadow: '0 2px 8px rgba(0,0,0,0.04)'
        }}>
          <div style={{
            background: 'linear-gradient(135deg, #007aff, #5ac8fa)',
            padding: '16px',
            color: 'white'
          }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
              <div style={{ fontSize: '32px' }}>{plan.hotel.image}</div>
              <div style={{ flex: 1 }}>
                <h3 style={{ fontSize: '17px', fontWeight: '600', marginBottom: '4px' }}>
                  {plan.hotel.name}
                </h3>
                <div style={{ fontSize: '13px', opacity: 0.9 }}>
                  {plan.title}
                </div>
              </div>
            </div>
          </div>
          
          <div style={{ padding: '16px' }}>
            {/* 酒店认证信息 */}
            <div style={{ display: 'flex', gap: '6px', marginBottom: '12px' }}>
              {plan.hotel.license === 'verified' && (
                <span className="trust-badge">✓ 营业执照</span>
              )}
              {plan.hotel.insurance && (
                <span className="trust-badge">🛡️ {plan.hotel.insurance}保险</span>
              )}
              {plan.hotel.staffTrained && (
                <span className="trust-badge">👨‍🎓 员工培训</span>
              )}
              {plan.hotel.superhost && (
                <span className="trust-badge">⭐ 超级房东</span>
              )}
            </div>

            <div style={{
              background: 'rgba(255, 149, 0, 0.1)',
              borderRadius: '8px',
              padding: '10px',
              marginBottom: '12px',
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center'
            }}>
              <div>
                <div style={{ fontSize: '20px', fontWeight: '700', color: '#ff9500' }}>
                  ¥{plan.totalPrice}
                </div>
                <div style={{ fontSize: '12px', color: '#86868b' }}>
                  {plan.subtitle}
                </div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }}>
                {[1,2,3,4,5].map(i => (
                  <span key={i} style={{ 
                    fontSize: '12px', 
                    color: i <= plan.rating ? '#ffa726' : '#e0e0e0' 
                  }}>⭐</span>
                ))}
              </div>
            </div>
            
            <div style={{ marginBottom: '12px' }}>
              <div style={{ fontSize: '14px', fontWeight: '500', color: '#1d1d1f', marginBottom: '6px' }}>
                酒店特色
              </div>
              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>
                {plan.features?.map((feature, idx) => (
                  <span key={idx} style={{
                    background: 'rgba(0, 122, 255, 0.08)',
                    color: '#007aff',
                    padding: '3px 8px',
                    borderRadius: '4px',
                    fontSize: '11px',
                    fontWeight: '500'
                  }}>
                    {feature}
                  </span>
                ))}
              </div>
            </div>
            
            <div style={{ marginBottom: '12px' }}>
              <div style={{ fontSize: '14px', fontWeight: '500', color: '#1d1d1f', marginBottom: '6px' }}>
                周边景点
              </div>
              <div style={{ fontSize: '12px', color: '#86868b', lineHeight: '1.5' }}>
                {plan.places?.map(p => p.name).join(' · ')}
              </div>
            </div>
            
            <div style={{ display: 'flex', gap: '8px' }}>
              <button
                onClick={() => onPreview(plan)}
                style={{
                  flex: 1,
                  padding: '10px',
                  background: '#f2f2f7',
                  color: '#007aff',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                预览行程
              </button>
              <button
                onClick={() => onBookHotel(plan.hotel)}
                style={{
                  flex: 1,
                  padding: '10px',
                  background: '#ff9500',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                一键预订
              </button>
              <button
                onClick={() => onSave(plan)}
                style={{
                  padding: '10px 16px',
                  background: isSaved ? '#30d158' : '#007aff',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                {isSaved ? '✓' : '收藏'}
              </button>
            </div>
          </div>
        </div>
      );

      const MapView = ({ places, onClose }) => (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'white',
          zIndex: 2000
        }}>
          <div style={{
            position: 'absolute',
            top: 0,
            left: 0,
            right: 0,
            background: 'rgba(255, 255, 255, 0.95)',
            padding: '12px 20px',
            borderBottom: '0.5px solid rgba(0,0,0,0.05)',
            zIndex: 10,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'space-between'
          }}>
            <button
              onClick={onClose}
              style={{
                background: 'none',
                border: 'none',
                fontSize: '16px',
                color: '#007aff',
                cursor: 'pointer',
                padding: '4px'
              }}
            >
              完成
            </button>
            <div style={{ fontSize: '17px', fontWeight: '600' }}>地图视图</div>
            <div style={{ width: '40px' }}></div>
          </div>
          
          <div style={{
            width: '100%',
            height: '100%',
            background: 'linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)',
            position: 'relative',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center'
          }}>
            <div style={{
              fontSize: '48px',
              color: '#007aff',
              textAlign: 'center'
            }}>
              🗺️
              <div style={{ fontSize: '16px', marginTop: '12px', color: '#1d1d1f' }}>
                地图加载中...
              </div>
            </div>
            
            {places?.map((place, index) => (
              <div
                key={place.id || index}
                style={{
                  position: 'absolute',
                  left: `${20 + (index * 25)}%`,
                  top: `${30 + (index * 15)}%`,
                  background: '#007aff',
                  color: 'white',
                  padding: '6px 10px',
                  borderRadius: '20px',
                  fontSize: '12px',
                  fontWeight: '500',
                  boxShadow: '0 2px 8px rgba(0,0,0,0.2)'
                }}
              >
                {index + 1} {place.name}
              </div>
            ))}
          </div>
        </div>
      );

      const PlanPreview = ({ plan, onClose, onSave, isSaved }) => {
        const places = plan.type === 'local' ? [plan.place] : plan.places;
        
        return (
          <div style={styles.modal}>
            <div style={{
              ...styles.modalContent,
              maxWidth: '500px',
              maxHeight: '90vh'
            }}>
              <div style={{ 
                display: 'flex', 
                justifyContent: 'space-between', 
                alignItems: 'center', 
                marginBottom: '20px',
                paddingBottom: '12px',
                borderBottom: '0.5px solid rgba(0,0,0,0.05)'
              }}>
                <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1d1d1f' }}>
                  {plan.type === 'local' ? '活动详情' : '行程预览'}
                </h3>
                <button 
                  onClick={onClose} 
                  style={{ 
                    background: 'none', 
                    border: 'none', 
                    fontSize: '24px', 
                    color: '#86868b',
                    cursor: 'pointer'
                  }}
                >
                  ×
                </button>
              </div>
              
              <div 
                onClick={() => setShowMapView(true)}
                style={{
                  height: '120px',
                  background: 'linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)',
                  borderRadius: '10px',
                  marginBottom: '16px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  cursor: 'pointer',
                  position: 'relative',
                  overflow: 'hidden'
                }}
              >
                <div style={{ textAlign: 'center', zIndex: 1 }}>
                  <div style={{ fontSize: '32px', marginBottom: '4px' }}>🗺️</div>
                  <div style={{ fontSize: '12px', color: '#007aff', fontWeight: '500' }}>
                    点击查看地图
                  </div>
                </div>
                {places?.slice(0, 3).map((place, index) => (
                  <div
                    key={index}
                    style={{
                      position: 'absolute',
                      left: `${15 + (index * 30)}%`,
                      top: `${20 + (index * 20)}%`,
                      width: '8px',
                      height: '8px',
                      background: '#007aff',
                      borderRadius: '50%',
                      border: '2px solid white',
                      boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                    }}
                  />
                ))}
              </div>
              
              {plan.type === 'local' ? (
                <div>
                  <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px' }}>
                    {plan.place.name}
                  </h4>
                  
                  {/* 信任指标展示 */}
                  <div style={{ marginBottom: '12px' }}>
                    {plan.place.staffVerified && (
                      <div className="trust-badge" style={{ marginRight: '6px', marginBottom: '4px' }}>
                        ✓ 员工实地验证
                      </div>
                    )}
                    {plan.place.expertReview && (
                      <div className="trust-badge" style={{ marginRight: '6px', marginBottom: '4px' }}>
                        👨‍⚕️ 专家认证
                      </div>
                    )}
                    {plan.place.safetyChecks?.certified && (
                      <div className="trust-badge" style={{ marginBottom: '4px' }}>
                        🛡️ 安全认证
                      </div>
                    )}
                  </div>

                  <div style={{ fontSize: '13px', color: '#86868b', lineHeight: '1.5', marginBottom: '12px' }}>
                    <div>📍 距离: {plan.place.distance}km</div>
                    <div>⏰ 开放时间: {plan.place.time}</div>
                    <div>⭐ 评分: {plan.place.rating}</div>
                    <div>🐾 宠物友好度: {'🐾'.repeat(plan.place.petFriendly)}</div>
                    {plan.place.realTimeStatus && (
                      <div style={{ marginTop: '6px' }}>
                        <span style={{ 
                          color: plan.place.realTimeStatus === 'open' ? '#30d158' : '#ff3b30',
                          fontWeight: '500'
                        }}>
                          🔴 {plan.place.realTimeStatus === 'open' ? '正常营业' : '暂停营业'}
                        </span>
                        <span style={{ marginLeft: '8px' }}>
                          人流: {plan.place.crowdLevel === 'low' ? '较少' : 
                               plan.place.crowdLevel === 'moderate' ? '适中' : '较多'}
                        </span>
                      </div>
                    )}
                  </div>
                  
                  {plan.place.expertReview && (
                    <div style={{
                      background: 'rgba(48, 209, 88, 0.1)',
                      borderRadius: '6px',
                      padding: '8px',
                      marginBottom: '12px',
                      fontSize: '12px'
                    }}>
                      <div style={{ fontWeight: '600', color: '#30d158', marginBottom: '2px' }}>
                        👨‍⚕️ 专家评价
                      </div>
                      <div style={{ color: '#86868b' }}>
                        {plan.place.expertReview.reviewer} 评分: {plan.place.expertReview.score}/10
                      </div>
                      <div style={{ color: '#86868b' }}>
                        评价日期: {plan.place.expertReview.date}
                      </div>
                    </div>
                  )}

                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ fontSize: '14px', fontWeight: '500', marginBottom: '6px' }}>特色</div>
                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>
                      {plan.place.features?.map((f, i) => (
                        <span key={i} style={{
                          background: 'rgba(0, 122, 255, 0.08)',
                          color: '#007aff',
                          padding: '3px 8px',
                          borderRadius: '4px',
                          fontSize: '11px'
                        }}>{f}</span>
                      ))}
                    </div>
                  </div>
                </div>
              ) : (
                <div>
                  <div style={{ marginBottom: '16px' }}>
                    <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px' }}>
                      住宿安排
                    </h4>
                    <div style={{
                      background: '#f8f9fb',
                      borderRadius: '8px',
                      padding: '12px'
                    }}>
                      <div style={{ fontSize: '15px', fontWeight: '500', marginBottom: '4px' }}>
                        {plan.hotel.name}
                      </div>
                      <div style={{ fontSize: '13px', color: '#86868b' }}>
                        ¥{plan.hotel.price}/晚 · 宠物费 ¥{plan.hotel.petFee}
                      </div>
                    </div>
                  </div>
                  
                  <div>
                    <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px' }}>
                      行程安排
                    </h4>
                    {places?.map((place, index) => (
                      <div key={index} style={{
                        background: '#f8f9fb',
                        borderRadius: '8px',
                        padding: '12px',
                        marginBottom: '8px'
                      }}>
                        <div style={{ fontSize: '14px', fontWeight: '500', marginBottom: '4px' }}>
                          Day {Math.floor(index / 2) + 1} - {place.name}
                        </div>
                        <div style={{ fontSize: '12px', color: '#86868b' }}>
                          距离 {place.distance}km · {place.time}
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}
              
              <div style={{ marginTop: '20px', paddingTop: '16px', borderTop: '0.5px solid rgba(0,0,0,0.05)' }}>
                <button
                  onClick={() => onSave(plan)}
                  style={{
                    ...styles.button,
                    background: isSaved ? '#30d158' : '#007aff'
                  }}
                >
                  {isSaved ? '✓ 已收藏到行程' : '收藏到我的行程'}
                </button>
              </div>
            </div>
          </div>
        );
      };

      // 城市选择模态框组件
      const CitySelectModal = () => (
        <div style={styles.modal} onClick={(e) => e.target === e.currentTarget && setShowCitySelect(false)}>
          <div style={styles.modalContent}>
            <div style={{ 
              display: 'flex', 
              justifyContent: 'space-between', 
              alignItems: 'center', 
              marginBottom: '20px',
              paddingBottom: '12px',
              borderBottom: '0.5px solid rgba(0,0,0,0.05)'
            }}>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1d1d1f' }}>选择位置</h3>
              <button 
                onClick={() => setShowCitySelect(false)} 
                style={{ 
                  background: 'none', 
                  border: 'none', 
                  fontSize: '22px', 
                  color: '#86868b',
                  cursor: 'pointer'
                }}
              >
                ×
              </button>
            </div>
            
            <div style={{ maxHeight: '60vh', overflowY: 'auto' }}>
              {CONFIG.cities.major.map(city => (
                <div key={city.name} style={{ marginBottom: '16px' }}>
                  <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '10px', color: '#1d1d1f', display: 'flex', alignItems: 'center', gap: '8px' }}>
                    {city.name} 
                    <span style={{ fontSize: '13px', color: '#86868b' }}>{city.weather} {city.temp}</span>
                  </div>
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px' }}>
                    {city.districts.map(district => (
                      <button
                        key={district}
                        onClick={() => handleCitySelect(city.name, district)}
                        style={{
                          padding: '12px 14px',
                          background: selectedCity === city.name && selectedDistrict === district 
                            ? '#007aff' 
                            : 'white',
                          color: selectedCity === city.name && selectedDistrict === district ? 'white' : '#1d1d1f',
                          border: '0.5px solid',
                          borderColor: selectedCity === city.name && selectedDistrict === district ? '#007aff' : 'rgba(0,0,0,0.08)',
                          borderRadius: '8px',
                          fontSize: '14px',
                          fontWeight: '500',
                          cursor: 'pointer',
                          fontFamily: 'inherit'
                        }}
                      >
                        {district}
                      </button>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      );

      // 主渲染
      if (page === 'planning') {
        return (
          <div style={styles.container} className={animationClass}>
            <div style={styles.header}>
              <div style={styles.logo}>
                <span style={{ color: '#1d1d1f' }}>Fun</span>
                <span style={{ color: '#007aff' }}>Go</span>
              </div>
            </div>

            <div style={styles.content}>
              {/* 信任指标展示 */}
              <TrustIndicatorBar />

              <div style={styles.section}>
                <div style={styles.sectionTitle}>今天想做什么？</div>
                <div style={styles.grid2}>
                  {[
                    { type: 'local', icon: '🎯', label: '找事做', desc: '附近活动' },
                    { type: 'travel', icon: '📅', label: '规划游', desc: '多日行程' }
                  ].map(item => (
                    <SelectableCard 
                      key={item.type}
                      selected={tripType === item.type}
                      onClick={() => handleTripTypeChange(item.type)}
                      size="large"
                    >
                      <div style={{ textAlign: 'center' }}>
                        <div style={{ fontSize: '28px', marginBottom: '10px' }}>{item.icon}</div>
                        <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '3px' }}>
                          {item.label}
                        </div>
                        <div style={{ fontSize: '12px', opacity: 0.7 }}>{item.desc}</div>
                      </div>
                    </SelectableCard>
                  ))}
                </div>
              </div>

              <div style={styles.section}>
                <div style={styles.sectionTitle}>
                  {tripType === 'local' ? '我在哪里' : '去哪里玩'}
                </div>
                <LocationCard />
                
                {tripType === 'local' && (
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '12px', color: '#1d1d1f' }}>
                      我的兴趣
                    </div>
                    <div style={styles.grid3}>
                      {CONFIG.interests.map(item => (
                        <SelectableCard 
                          key={item.id}
                          selected={preferences.includes(item.label)}
                          onClick={() => handleToggleInterest(item.label)}
                          size="small"
                        >
                          <div style={{ textAlign: 'center' }}>
                            <div style={{ fontSize: '20px', marginBottom: '6px' }}>{item.icon}</div>
                            <div style={{ fontSize: '11px', fontWeight: '500', lineHeight: '1.2' }}>
                              {item.label}
                            </div>
                          </div>
                        </SelectableCard>
                      ))}
                    </div>
                  </div>
                )}
                
                {tripType === 'travel' && (
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '12px', color: '#1d1d1f' }}>
                      出行天数
                    </div>
                    <div style={styles.grid2}>
                      {CONFIG.durations.map(item => (
                        <SelectableCard 
                          key={item.value}
                          selected={duration === item.value}
                          onClick={() => setDuration(item.value)}
                        >
                          <div>
                            <div style={{ fontWeight: '600', fontSize: '16px', marginBottom: '3px' }}>
                              {item.label}
                            </div>
                            <div style={{ fontSize: '12px', opacity: 0.7 }}>
                              {item.desc}
                            </div>
                          </div>
                        </SelectableCard>
                      ))}
                    </div>
                  </div>
                )}
              </div>

              <div style={styles.section}>
                <div style={styles.sectionTitle}>我的伙伴</div>
                
                {pets.map(pet => (
                  <div key={pet.id} style={{
                    display: 'flex', 
                    alignItems: 'center', 
                    gap: '14px', 
                    padding: '16px',
                    background: 'white', 
                    borderRadius: '12px', 
                    marginBottom: '10px',
                    border: '0.5px solid rgba(0,0,0,0.04)'
                  }}>
                    <div style={{
                      fontSize: '24px', 
                      width: '48px', 
                      height: '48px', 
                      background: '#f2f2f7', 
                      borderRadius: '50%', 
                      display: 'flex', 
                      alignItems: 'center', 
                      justifyContent: 'center'
                    }}>
                      {pet.emoji}
                    </div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '2px', color: '#1d1d1f' }}>
                        {pet.name}
                      </div>
                      <div style={{ fontSize: '14px', color: '#86868b' }}>
                        {pet.type} · {pet.weight}
                      </div>
                    </div>
                    {pets.length > 1 && (
                      <button 
                        onClick={() => handleRemovePet(pet.id)} 
                        style={{ 
                          background: 'none', 
                          border: 'none', 
                          color: '#ff3b30', 
                          fontSize: '18px',
                          cursor: 'pointer',
                          padding: '6px'
                        }}
                      >
                        ×
                      </button>
                    )}
                  </div>
                ))}
                
                <button 
                  onClick={() => setShowAddPet(true)} 
                  style={{
                    ...styles.button,
                    ...styles.buttonSecondary,
                    fontSize: '15px'
                  }}
                >
                  + 添加宠物
                </button>
              </div>

              {savedPlans.length > 0 && (
                <div style={styles.section}>
                  <div style={styles.sectionTitle}>
                    我的收藏 ({savedPlans.length})
                  </div>
                  <div style={{
                    background: 'white',
                    borderRadius: '12px',
                    padding: '12px',
                    border: '0.5px solid rgba(0,0,0,0.04)'
                  }}>
                    {savedPlans.map((plan, index) => (
                      <div key={plan.id} style={{
                        fontSize: '14px',
                        padding: '8px 0',
                        borderBottom: index < savedPlans.length - 1 ? '0.5px solid rgba(0,0,0,0.05)' : 'none'
                      }}>
                        {plan.title}
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>

            <div style={styles.bottomBar}>
              <button 
                onClick={generatePlans} 
                disabled={!isFormValid} 
                style={{
                  ...styles.button,
                  background: isFormValid ? '#007aff' : '#d1d1d6',
                  color: isFormValid ? 'white' : '#86868b',
                  cursor: isFormValid ? 'pointer' : 'not-allowed'
                }}
              >
                {loading ? (
                  <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px' }}>
                    <div className="spin" style={{ 
                      width: '14px', 
                      height: '14px', 
                      border: '2px solid rgba(255,255,255,0.3)', 
                      borderTop: '2px solid white', 
                      borderRadius: '50%' 
                    }}></div>
                    生成中...
                  </div>
                ) : (
                  tripType === 'local' ? '智能推荐' : '生成行程'
                )}
              </button>
            </div>

            {/* 添加宠物模态框 */}
            {showAddPet && (
              <div style={styles.modal} onClick={(e) => e.target === e.currentTarget && setShowAddPet(false)}>
                <div style={styles.modalContent}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                    <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1d1d1f' }}>添加宠物</h3>
                    <button 
                      onClick={() => setShowAddPet(false)} 
                      style={{ 
                        background: 'none', 
                        border: 'none', 
                        fontSize: '22px', 
                        color: '#86868b',
                        cursor: 'pointer'
                      }}
                    >
                      ×
                    </button>
                  </div>
                  <input 
                    type="text" 
                    placeholder="宠物名字" 
                    value={newPet.name} 
                    onChange={(e) => setNewPet({...newPet, name: e.target.value})} 
                    style={styles.input}
                  />
                  <input 
                    type="text" 
                    placeholder="品种" 
                    value={newPet.type} 
                    onChange={(e) => setNewPet({...newPet, type: e.target.value})} 
                    style={styles.input}
                  />
                  <input 
                    type="text" 
                    placeholder="体重" 
                    value={newPet.weight} 
                    onChange={(e) => setNewPet({...newPet, weight: e.target.value})} 
                    style={styles.input}
                  />
                  <button 
                    onClick={handleAddPet} 
                    style={styles.button}
                  >
                    确认添加
                  </button>
                </div>
              </div>
            )}

            {/* 城市选择模态框 */}
            {showCitySelect && <CitySelectModal />}

            {/* 信任详情模态框 */}
            {showTrustDetails && <TrustDetailsModal />}
          </div>
        );
      }

      if (page === 'plans') {
        const plans = tripType === 'local' ? getLocalPlans() : getTravelPlans();
        
        return (
          <div style={styles.container} className="fade-in">
            <div style={styles.header}>
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
                <button 
                  onClick={() => setPage('planning')}
                  style={{
                    background: 'none',
                    border: 'none',
                    fontSize: '16px',
                    color: '#007aff',
                    cursor: 'pointer',
                    padding: '4px'
                  }}
                >
                  ‹ 返回
                </button>
                <div style={{ fontSize: '17px', fontWeight: '600', color: '#1d1d1f' }}>
                  {tripType === 'local' ? '今日推荐' : '行程方案'}
                </div>
                <button 
                  onClick={() => setShowMapView(true)}
                  style={{
                    background: 'none',
                    border: 'none',
                    fontSize: '20px',
                    cursor: 'pointer',
                    padding: '4px'
                  }}
                >
                  🗺️
                </button>
              </div>
            </div>

            <div style={styles.content}>
              {tripType === 'local' && (
                <div style={{
                  background: 'linear-gradient(135deg, rgba(48, 209, 88, 0.1), rgba(52, 199, 89, 0.1))',
                  borderRadius: '10px',
                  padding: '14px',
                  marginBottom: '16px',
                  border: '1px solid rgba(48, 209, 88, 0.2)'
                }}>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                    <span style={{ fontSize: '16px' }}>{currentTimeSlot.icon}</span>
                    <div>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#1d1d1f' }}>
                        {currentTimeSlot.label}好，{pets[0]?.name || '您的宠物'}！
                      </div>
                      <div style={{ fontSize: '12px', color: '#86868b', marginTop: '2px' }}>
                        根据当前时间和您的位置，为您推荐以下活动
                      </div>
                    </div>
                  </div>
                </div>
              )}

              <div style={{
                background: 'white',
                borderRadius: '12px',
                padding: '12px',
                marginBottom: '16px',
                border: '0.5px solid rgba(0,0,0,0.04)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'space-between'
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                  <div style={{
                    width: '32px',
                    height: '32px',
                    background: 'linear-gradient(135deg, #007aff, #5ac8fa)',
                    borderRadius: '50%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    fontSize: '16px'
                  }}>
                    🤖
                  </div>
                  <div>
                    <div style={{ fontSize: '14px', fontWeight: '600', color: '#1d1d1f' }}>
                      FunGo AI 智能推荐引擎
                    </div>
                    <div style={{ fontSize: '12px', color: '#86868b' }}>
                      {aiAnalyzing ? '正在重新分析中...' : 
                       lastAnalysisTime ? `上次分析: ${lastAnalysisTime.toLocaleTimeString()}` : '已完成智能分析'}
                    </div>
                  </div>
                </div>
                <button
                  onClick={triggerAiAnalysis}
                  disabled={aiAnalyzing}
                  style={{
                    background: aiAnalyzing ? '#f2f2f7' : 'rgba(0, 122, 255, 0.1)',
                    color: aiAnalyzing ? '#86868b' : '#007aff',
                    border: 'none',
                    borderRadius: '8px',
                    padding: '8px 12px',
                    fontSize: '12px',
                    fontWeight: '500',
                    cursor: aiAnalyzing ? 'not-allowed' : 'pointer',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '4px'
                  }}
                >
                  {aiAnalyzing ? (
                    <>
                      <div className="spin" style={{ 
                        width: '10px', 
                        height: '10px', 
                        border: '1px solid rgba(134,134,139,0.3)', 
                        borderTop: '1px solid #86868b', 
                        borderRadius: '50%' 
                      }}></div>
                      分析中
                    </>
                  ) : (
                    <>🔄 重新分析</>
                  )}
                </button>
              </div>

              <div style={styles.section}>
                {tripType === 'local' ? (
                  plans.map((plan, index) => (
                    <div key={plan.id} className="slide-in" style={{ animationDelay: `${index * 0.1}s` }}>
                      <LocalPlanCard 
                        plan={plan}
                        isSaved={savedPlans.some(p => p.id === plan.id)}
                        onSave={handleSavePlan}
                        onPreview={(plan) => setCurrentPlan(plan)}
                      />
                    </div>
                  ))
                ) : (
                  plans.map((plan, index) => (
                    <div key={plan.id} className="slide-in" style={{ animationDelay: `${index * 0.1}s` }}>
                      <TravelPlanCard 
                        plan={plan}
                        isSaved={savedPlans.some(p => p.id === plan.id)}
                        onSave={handleSavePlan}
                        onPreview={(plan) => setCurrentPlan(plan)}
                        onBookHotel={(hotel) => {
                          alert(`预订 ${hotel.name}\n价格: ¥${hotel.price}/晚\n宠物费: ¥${hotel.petFee}`);
                        }}
                      />
                    </div>
                  ))
                )}
              </div>

              <div style={{ textAlign: 'center', marginTop: '20px' }}>
                <button
                  style={{
                    background: 'none',
                    border: 'none',
                    color: '#007aff',
                    fontSize: '14px',
                    fontWeight: '500',
                    cursor: 'pointer',
                    padding: '8px 16px'
                  }}
                  onClick={() => alert('加载更多推荐')}
                >
                  查看更多 →
                </button>
              </div>

              <div style={{
                background: 'rgba(0, 122, 255, 0.05)',
                borderRadius: '10px',
                padding: '12px',
                marginTop: '16px',
                border: '0.5px solid rgba(0, 122, 255, 0.1)'
              }}>
                <div style={{ fontSize: '12px', fontWeight: '600', color: '#007aff', marginBottom: '6px' }}>
                  📊 推荐算法透明度
                </div>
                <div style={{ fontSize: '11px', color: '#86868b', lineHeight: '1.4' }}>
                  我们的推荐基于多维度数据：外部平台用户评价(75%)、FunGo员工实地踩点(15%)、用户反馈(10%)。
                  所有数据实时更新，确保推荐的准确性和时效性。
                </div>
                <div style={{ marginTop: '8px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                  <button
                    onClick={() => setShowTrustDetails(true)}
                    style={{
                      background: 'rgba(0, 122, 255, 0.1)',
                      color: '#007aff',
                      border: 'none',
                      borderRadius: '6px',
                      padding: '4px 8px',
                      fontSize: '10px',
                      fontWeight: '500',
                      cursor: 'pointer'
                    }}
                  >
                    查看详细保障体系
                  </button>
                  <div style={{ fontSize: '10px', color: '#30d158' }}>
                    🟢 实时监控中 · 最后更新: {realTimeData.lastUpdate.toLocaleTimeString()}
                  </div>
                </div>
              </div>
            </div>

            <div style={styles.bottomBar}>
              <div style={{ 
                display: 'flex', 
                alignItems: 'center', 
                justifyContent: 'space-between',
                fontSize: '14px'
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                  <div style={{ color: '#86868b' }}>
                    已收藏 {savedPlans.length} 个方案
                  </div>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '4px', fontSize: '12px', color: '#007aff' }}>
                    <span>🤖</span>
                    <span>AI推荐</span>
                  </div>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '4px', fontSize: '12px', color: '#30d158' }}>
                    <span>🛡️</span>
                    <span>信任保障</span>
                  </div>
                </div>
                {savedPlans.length > 0 && (
                  <button
                    onClick={() => {
                      alert(`已收藏的方案:\n${savedPlans.map(p => p.title).join('\n')}`);
                    }}
                    style={{
                      background: '#007aff',
                      color: 'white',
                      border: 'none',
                      borderRadius: '8px',
                      padding: '8px 16px',
                      fontSize: '14px',
                      fontWeight: '500',
                      cursor: 'pointer'
                    }}
                  >
                    查看收藏
                  </button>
                )}
              </div>
            </div>

            {/* 预览模态框 */}
            {currentPlan && (
              <PlanPreview 
                plan={currentPlan}
                onClose={() => setCurrentPlan(null)}
                onSave={handleSavePlan}
                isSaved={savedPlans.some(p => p.id === currentPlan.id)}
              />
            )}

            {/* 地图视图 */}
            {showMapView && (
              <MapView 
                places={tripType === 'local' ? plans.map(p => p.place) : plans[0]?.places}
                onClose={() => setShowMapView(false)}
              />
            )}

            {/* 信任详情模态框 */}
            {showTrustDetails && <TrustDetailsModal />}
          </div>
        );
      }

      return null;
    };

    // 渲染应用
    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
