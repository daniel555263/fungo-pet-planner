<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FunGo å® ç‰©æ—…è¡Œè§„åˆ’å™¨ - ä¿¡ä»»å¢å¼ºç‰ˆ</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
    }
    
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Helvetica Neue", sans-serif; 
      background: #f8f9fb;
      min-height: 100vh;
      color: #1d1d1f;
      line-height: 1.4;
    }
    
    @keyframes spin { 
      to { transform: rotate(360deg); } 
    }
    
    @keyframes fadeInUp { 
      from { opacity: 0; transform: translateY(30px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    
    @keyframes slideInLeft {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes shimmer {
      0% { background-position: -468px 0; }
      100% { background-position: 468px 0; }
    }
    
    .spin { animation: spin 1s linear infinite; }
    .fade-in { animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
    .slide-in { animation: slideInLeft 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
    .pulse { animation: pulse 2s infinite; }
    .shimmer {
      background: linear-gradient(to right, #f6f7f8 0%, #edeef1 20%, #f6f7f8 40%, #f6f7f8 100%);
      background-size: 800px 104px;
      animation: shimmer 1s linear infinite;
    }
    
    ::-webkit-scrollbar {
      width: 6px;
      height: 6px;
    }
    
    ::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 3px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: #555;
    }

    .trust-badge {
      background: linear-gradient(135deg, rgba(48, 209, 88, 0.1), rgba(52, 199, 89, 0.05));
      border: 1px solid rgba(48, 209, 88, 0.3);
      border-radius: 6px;
      padding: 4px 8px;
      font-size: 10px;
      font-weight: 600;
      color: #30d158;
      display: inline-flex;
      align-items: center;
      gap: 3px;
    }

    .verification-indicator {
      width: 12px;
      height: 12px;
      background: linear-gradient(135deg, #30d158, #34c759);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 8px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useMemo, useCallback } = React;

    // è·å–å½“å‰æ—¶æ®µ
    const getCurrentTimeSlot = () => {
      const hour = new Date().getHours();
      if (hour >= 6 && hour < 9) return { slot: 'morning', label: 'æ—©æ™¨', icon: 'ğŸŒ…', activity: 'æ™¨ç»ƒé›ç‹—' };
      if (hour >= 9 && hour < 12) return { slot: 'forenoon', label: 'ä¸Šåˆ', icon: 'â˜€ï¸', activity: 'æˆ·å¤–æ´»åŠ¨' };
      if (hour >= 12 && hour < 14) return { slot: 'noon', label: 'ä¸­åˆ', icon: 'ğŸŒ', activity: 'ä¼‘é—²æ—¶å…‰' };
      if (hour >= 14 && hour < 17) return { slot: 'afternoon', label: 'ä¸‹åˆ', icon: 'ğŸŒ¤ï¸', activity: 'æ¢ç´¢æ¸¸ç©' };
      if (hour >= 17 && hour < 19) return { slot: 'evening', label: 'å‚æ™š', icon: 'ğŸŒ†', activity: 'æ•£æ­¥æ—¶é—´' };
      if (hour >= 19 && hour < 22) return { slot: 'night', label: 'å¤œæ™š', icon: 'ğŸŒƒ', activity: 'å¤œæ¸¸ä½“éªŒ' };
      return { slot: 'late', label: 'æ·±å¤œ', icon: 'ğŸŒ™', activity: 'å®‰é™ä¼‘æ¯' };
    };

    // å¢å¼ºçš„æ•°æ®é…ç½®
    const CONFIG = {
      cities: {
        major: [
          { name: 'åŒ—äº¬', districts: ['æœé˜³åŒº', 'æµ·æ·€åŒº', 'è¥¿åŸåŒº', 'ä¸œåŸåŒº'], weather: 'â˜€ï¸', temp: '24Â°C' },
          { name: 'ä¸Šæµ·', districts: ['æµ¦ä¸œæ–°åŒº', 'é»„æµ¦åŒº', 'é™å®‰åŒº', 'å¾æ±‡åŒº'], weather: 'â›…', temp: '26Â°C' },
          { name: 'å¹¿å·', districts: ['å¤©æ²³åŒº', 'è¶Šç§€åŒº', 'æµ·ç åŒº', 'è”æ¹¾åŒº'], weather: 'ğŸŒ¦ï¸', temp: '29Â°C' },
          { name: 'æ·±åœ³', districts: ['å—å±±åŒº', 'ç¦ç”°åŒº', 'ç½—æ¹–åŒº', 'å®å®‰åŒº'], weather: 'â˜€ï¸', temp: '28Â°C' },
          { name: 'æ­å·', districts: ['è¥¿æ¹–åŒº', 'æ‹±å¢…åŒº', 'æ±Ÿå¹²åŒº', 'ä¸‹åŸåŒº'], weather: 'ğŸŒ¦ï¸', temp: '22Â°C' },
          { name: 'æˆéƒ½', districts: ['é”¦æ±ŸåŒº', 'é’ç¾ŠåŒº', 'é‡‘ç‰›åŒº', 'æ­¦ä¾¯åŒº'], weather: 'â˜ï¸', temp: '20Â°C' }
        ]
      },
      interests: [
        { id: 'beach', label: 'ç©æ°´å¬‰æˆ', icon: 'ğŸ–ï¸' },
        { id: 'run', label: 'ç‹—ç‹—å¥”è·‘', icon: 'ğŸƒ' },
        { id: 'cafe', label: 'å–ä¸‹åˆèŒ¶', icon: 'â˜•' },
        { id: 'park', label: 'å…¬å›­æ¼«æ­¥', icon: 'ğŸŒ³' },
        { id: 'photo', label: 'æ‹ç…§æ‰“å¡', icon: 'ğŸ“¸' },
        { id: 'food', label: 'ç¾é£Ÿæ¢åº—', icon: 'ğŸ½ï¸' },
        { id: 'mountain', label: 'ç™»å±±å¾’æ­¥', icon: 'ğŸ”ï¸' },
        { id: 'lake', label: 'æ¹–è¾¹ä¼‘é—²', icon: 'ğŸï¸' }
      ],
      durations: [
        { value: '2', label: '2å¤©1å¤œ', desc: 'å‘¨æœ«çŸ­é€”' },
        { value: '3', label: '3å¤©2å¤œ', desc: 'å°é•¿å‡' },
        { value: '5', label: '5å¤©4å¤œ', desc: 'æ·±åº¦æ¸¸' },
        { value: '7', label: '7å¤©6å¤œ', desc: 'åº¦å‡æ¸¸' }
      ],
      dataSources: {
        external: [
          { name: 'å°çº¢ä¹¦', logo: 'ğŸŒº', weight: 30, freshness: 95, trustScore: 4.8, sampleSize: '12ä¸‡+' },
          { name: 'å¤§ä¼—ç‚¹è¯„', logo: 'ğŸ½ï¸', weight: 25, freshness: 88, trustScore: 4.6, sampleSize: '8ä¸‡+' },
          { name: 'ç¾å›¢', logo: 'ğŸ›ï¸', weight: 20, freshness: 92, trustScore: 4.7, sampleSize: '15ä¸‡+' }
        ],
        internal: [
          { name: 'FunGoè¸©ç‚¹', logo: 'ğŸ‘¥', weight: 15, freshness: 98, trustScore: 4.9, sampleSize: 'ä¸“ä¸šå›¢é˜Ÿ' },
          { name: 'ç”¨æˆ·è¯„ä»·', logo: 'â­', weight: 10, freshness: 90, trustScore: 4.5, sampleSize: '5ä¸‡+' }
        ]
      },
      // æ–°å¢ï¼šä¿¡ä»»åº¦ç›¸å…³é…ç½®
      trustIndicators: {
        realTimeVerification: {
          enabled: true,
          interval: 300000, // 5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡
          lastCheck: null
        },
        expertVerification: {
          team: [
            { name: 'ææ™“èŒ', role: 'å® ç‰©è¡Œä¸ºä¸“å®¶', cert: 'å›½é™…å® ç‰©è¡Œä¸ºå¸ˆè®¤è¯', years: 8 },
            { name: 'å¼ æ˜å', role: 'æ—…æ¸¸è§„åˆ’å¸ˆ', cert: 'CTAæ—…æ¸¸é¡¾é—®è®¤è¯', years: 12 },
            { name: 'ç‹é›…çª', role: 'å® ç‰©åŒ»å¸ˆ', cert: 'æ‰§ä¸šå…½åŒ»å¸ˆ', years: 6 }
          ]
        },
        userFeedback: {
          totalUsers: 158642,
          satisfaction: 96.8,
          monthlyActive: 45230
        }
      },
      recommendReasons: {
        timeMatch: ['é€‚åˆå½“å‰æ—¶æ®µ', 'æ­£å€¼æ´»è·ƒæ—¶é—´', 'ç°åœ¨å»æ­£åˆé€‚'],
        preference: ['ç¬¦åˆæ‚¨çš„å…´è¶£åå¥½', 'æ ¹æ®æ‚¨çš„é€‰æ‹©æ¨è', 'ä¸ºæ‚¨é‡èº«å®šåˆ¶'],
        petFriendly: ['å® ç‰©è¶…çº§å‹å¥½', 'æ¯›å­©å­ä»¬çš„å¤©å ‚', 'ä¸“ä¸ºå® ç‰©è®¾è®¡'],
        popular: ['æœ€è¿‘å¾ˆå—æ¬¢è¿', 'ç”¨æˆ·å¥½è¯„å¦‚æ½®', 'çƒ­é—¨æ¨èåœ°ç‚¹'],
        distance: ['è·ç¦»é€‚ä¸­', 'å°±åœ¨é™„è¿‘', 'æ­¥è¡Œå¯è¾¾'],
        weather: ['é€‚åˆå½“å‰å¤©æ°”', 'å¤©æ°”æ¡ä»¶å®Œç¾', 'æˆ·å¤–ä½“éªŒä½³'],
        verified: ['ä¸“å®¶å®åœ°éªŒè¯', 'å›¢é˜Ÿäº²æµ‹æ¨è', 'æƒå¨è®¤è¯åœºæ‰€']
      },
      mockPlaces: {
        'æ·±åœ³-å—å±±åŒº': [
          { 
            id: 1, name: 'æ·±åœ³æ¹¾å…¬å›­', type: 'park', distance: 1.2, rating: 4.8, petFriendly: 5, 
            time: 'å…¨å¤©', features: ['å® ç‰©ä¸“åŒº', 'æµ·æ»¨æ­¥é“'], aiScore: 94,
            dataSources: ['å°çº¢ä¹¦', 'FunGoè¸©ç‚¹', 'ç”¨æˆ·è¯„ä»·'], popularity: 'high',
            lastUpdated: '2åˆ†é’Ÿå‰', userFeedback: { likes: 1247, dislikes: 23 }, 
            staffVerified: true, realTimeStatus: 'open', crowdLevel: 'moderate',
            expertReview: { reviewer: 'ææ™“èŒ', date: '2024-08-15', score: 9.2 },
            safetyChecks: { lastInspection: '2024-08-18', issues: 0, certified: true }
          },
          { 
            id: 2, name: 'MUJIå’–å•¡', type: 'cafe', distance: 0.8, rating: 4.6, petFriendly: 4, 
            time: '10:00-22:00', features: ['å® ç‰©å‹å¥½', 'ä¸‹åˆèŒ¶'], aiScore: 87,
            dataSources: ['å¤§ä¼—ç‚¹è¯„', 'å°çº¢ä¹¦'], popularity: 'medium',
            lastUpdated: '5åˆ†é’Ÿå‰', userFeedback: { likes: 892, dislikes: 45 }, 
            staffVerified: false, realTimeStatus: 'open', crowdLevel: 'low',
            businessLicense: 'verified', healthRating: 'Açº§'
          },
          { 
            id: 3, name: 'æ¬¢ä¹æµ·å²¸', type: 'food', distance: 2.1, rating: 4.7, petFriendly: 4, 
            time: '10:00-22:00', features: ['æˆ·å¤–åº§ä½', 'ç¾é£Ÿè¡—'], aiScore: 91,
            dataSources: ['ç¾å›¢', 'å¤§ä¼—ç‚¹è¯„', 'FunGoè¸©ç‚¹'], popularity: 'high',
            lastUpdated: '1åˆ†é’Ÿå‰', userFeedback: { likes: 2156, dislikes: 67 }, 
            staffVerified: true, realTimeStatus: 'open', crowdLevel: 'high',
            expertReview: { reviewer: 'å¼ æ˜å', date: '2024-08-16', score: 8.9 }
          }
        ],
        'åŒ—äº¬-æœé˜³åŒº': [
          { 
            id: 11, name: 'æœé˜³å…¬å›­', type: 'park', distance: 1.5, rating: 4.7, petFriendly: 5, 
            time: 'å…¨å¤©', features: ['å¤§è‰åª', 'å® ç‰©è®­ç»ƒåŒº'], aiScore: 89,
            dataSources: ['å¤§ä¼—ç‚¹è¯„', 'FunGoè¸©ç‚¹'], popularity: 'high',
            lastUpdated: '3åˆ†é’Ÿå‰', userFeedback: { likes: 1876, dislikes: 34 }, 
            staffVerified: true, realTimeStatus: 'open', crowdLevel: 'moderate'
          }
        ]
      },
      mockHotels: [
        { 
          id: 'h1', name: 'æ·±åœ³æ¹¾å® ç‰©å‹å¥½é…’åº—', price: 688, rating: 4.8, petFee: 100, 
          features: ['å® ç‰©SPA', 'ä¸“å±æˆ¿é—´', '24hæœåŠ¡'], image: 'ğŸ¨',
          license: 'verified', insurance: 'å…¨è¦†ç›–', staffTrained: true
        },
        { 
          id: 'h2', name: 'å¸Œå°”é¡¿æ¬¢æœ‹é…’åº—', price: 528, rating: 4.6, petFee: 80, 
          features: ['å® ç‰©åºŠå«', 'é›ç‹—åŒºåŸŸ', 'å® ç‰©é¤å…·'], image: 'ğŸ¢',
          license: 'verified', insurance: 'æ ‡å‡†è¦†ç›–', staffTrained: true
        },
        { 
          id: 'h3', name: 'æ°‘å®¿Â·æ¯›å­©å­ä¹‹å®¶', price: 398, rating: 4.9, petFee: 0, 
          features: ['ç‹¬æ ‹åˆ«å¢…', 'ç§äººèŠ±å›­', 'å® ç‰©æ¸¸æ³³æ± '], image: 'ğŸ¡',
          license: 'verified', hostVerified: true, superhost: true
        }
      ]
    };

    const App = () => {
      // çŠ¶æ€ç®¡ç†
      const [page, setPage] = useState('planning');
      const [tripType, setTripType] = useState('local');
      const [selectedCity, setSelectedCity] = useState('æ·±åœ³');
      const [selectedDistrict, setSelectedDistrict] = useState('å—å±±åŒº');
      const [duration, setDuration] = useState('');
      const [pets, setPets] = useState([{ id: 1, name: 'æ—ºè´¢', type: 'é‡‘æ¯›', emoji: 'ğŸ•', weight: '25kg' }]);
      const [preferences, setPreferences] = useState([]);
      const [savedPlans, setSavedPlans] = useState([]);
      const [currentPlan, setCurrentPlan] = useState(null);
      const [showAddPet, setShowAddPet] = useState(false);
      const [showCitySelect, setShowCitySelect] = useState(false);
      const [showMapView, setShowMapView] = useState(false);
      const [showTrustDetails, setShowTrustDetails] = useState(false);
      const [newPet, setNewPet] = useState({ name: '', type: '', weight: '' });
      const [loading, setLoading] = useState(false);
      const [animationClass, setAnimationClass] = useState('');
      const [aiAnalyzing, setAiAnalyzing] = useState(false);
      const [lastAnalysisTime, setLastAnalysisTime] = useState(null);
      const [realTimeData, setRealTimeData] = useState({ lastUpdate: new Date(), isLive: true });

      const currentTimeSlot = getCurrentTimeSlot();

      useEffect(() => {
        setAnimationClass('fade-in');
        setLastAnalysisTime(new Date());
        
        // æ¨¡æ‹Ÿå®æ—¶æ•°æ®æ›´æ–°
        const interval = setInterval(() => {
          setRealTimeData({ lastUpdate: new Date(), isLive: true });
        }, 30000);
        
        return () => clearInterval(interval);
      }, []);

      // è®¡ç®—å±æ€§
      const currentCityData = useMemo(() => 
        CONFIG.cities.major.find(city => city.name === selectedCity) || CONFIG.cities.major[3], 
        [selectedCity]
      );

      const isFormValid = useMemo(() => 
        selectedCity && tripType && pets.length > 0 && (tripType === 'local' || duration), 
        [selectedCity, tripType, pets.length, duration]
      );

      // ç”Ÿæˆæ™ºèƒ½æ¨èç†ç”±
      const generateRecommendReason = useCallback((place, index) => {
        const reasons = [];
        const { recommendReasons } = CONFIG;
        
        if (index === 0) {
          reasons.push(recommendReasons.timeMatch[Math.floor(Math.random() * recommendReasons.timeMatch.length)]);
        }
        
        if (preferences.length > 0) {
          reasons.push(recommendReasons.preference[Math.floor(Math.random() * recommendReasons.preference.length)]);
        }
        
        if (place.petFriendly >= 4) {
          reasons.push(recommendReasons.petFriendly[Math.floor(Math.random() * recommendReasons.petFriendly.length)]);
        }
        
        if (place.staffVerified) {
          reasons.push(recommendReasons.verified[Math.floor(Math.random() * recommendReasons.verified.length)]);
        }
        
        if (place.aiScore >= 90) {
          reasons.push(recommendReasons.popular[Math.floor(Math.random() * recommendReasons.popular.length)]);
        }
        
        if (place.distance <= 2) {
          reasons.push(recommendReasons.distance[Math.floor(Math.random() * recommendReasons.distance.length)]);
        }
        
        return reasons.slice(0, 3);
      }, [preferences]);

      // æ™ºèƒ½é‡æ–°åˆ†æ
      const triggerAiAnalysis = useCallback(() => {
        setAiAnalyzing(true);
        setTimeout(() => {
          setAiAnalyzing(false);
          setLastAnalysisTime(new Date());
        }, 2000);
      }, []);

      // è·å–æ¨èæ–¹æ¡ˆ
      const getLocalPlans = useCallback(() => {
        const places = CONFIG.mockPlaces[`${selectedCity}-${selectedDistrict}`] || CONFIG.mockPlaces['æ·±åœ³-å—å±±åŒº'];
        
        let filteredPlaces = [...places];
        
        if (preferences.length > 0) {
          const interestMap = {
            'ç©æ°´å¬‰æˆ': ['beach', 'lake'],
            'ç‹—ç‹—å¥”è·‘': ['park', 'mountain'],
            'å–ä¸‹åˆèŒ¶': ['cafe'],
            'å…¬å›­æ¼«æ­¥': ['park'],
            'æ‹ç…§æ‰“å¡': ['park', 'beach', 'mountain', 'photo'],
            'ç¾é£Ÿæ¢åº—': ['food'],
            'ç™»å±±å¾’æ­¥': ['mountain'],
            'æ¹–è¾¹ä¼‘é—²': ['lake']
          };
          
          filteredPlaces = filteredPlaces.filter(place => {
            return preferences.some(pref => {
              const types = interestMap[pref] || [];
              return types.includes(place.type);
            });
          });
        }
        
        filteredPlaces.sort((a, b) => a.distance - b.distance);
        
        return filteredPlaces.slice(0, 3).map((place, index) => ({
          id: `local-${index}`,
          place,
          title: place.name,
          subtitle: `è·ç¦» ${place.distance}km Â· ${place.time}`,
          type: 'local',
          features: place.features,
          rating: place.rating,
          petFriendly: place.petFriendly,
          timeRecommend: index === 0 ? currentTimeSlot.activity : null,
          aiScore: place.aiScore,
          dataSources: place.dataSources,
          lastUpdated: place.lastUpdated,
          userFeedback: place.userFeedback,
          staffVerified: place.staffVerified,
          recommendReasons: generateRecommendReason(place, index),
          realTimeStatus: place.realTimeStatus,
          crowdLevel: place.crowdLevel,
          expertReview: place.expertReview,
          safetyChecks: place.safetyChecks
        }));
      }, [selectedCity, selectedDistrict, preferences, currentTimeSlot, generateRecommendReason]);

      const getTravelPlans = useCallback(() => {
        const hotels = CONFIG.mockHotels;
        const places = CONFIG.mockPlaces[`${selectedCity}-${selectedDistrict}`] || CONFIG.mockPlaces['æ·±åœ³-å—å±±åŒº'];
        
        return hotels.slice(0, 2).map((hotel, index) => ({
          id: `travel-${index}`,
          hotel,
          title: `${duration}å¤©${parseInt(duration) - 1}å¤œ Â· ${hotel.name}`,
          subtitle: `Â¥${hotel.price}/æ™š Â· å® ç‰©è´¹Â¥${hotel.petFee}`,
          type: 'travel',
          places: places.slice(0, 3),
          totalPrice: hotel.price * (parseInt(duration) - 1) + hotel.petFee,
          features: hotel.features,
          rating: hotel.rating
        }));
      }, [selectedCity, selectedDistrict, duration]);

      // äº‹ä»¶å¤„ç†
      const handleTripTypeChange = (type) => {
        setTripType(type);
        if (type === 'local') {
          setDuration('');
        }
      };

      const handleAddPet = () => {
        if (newPet.name && newPet.type && newPet.weight) {
          setPets(prev => [...prev, { ...newPet, id: Date.now(), emoji: 'ğŸ•' }]);
          setNewPet({ name: '', type: '', weight: '' });
          setShowAddPet(false);
        }
      };

      const handleRemovePet = (id) => {
        if (pets.length > 1) {
          setPets(prev => prev.filter(p => p.id !== id));
        }
      };

      const handleToggleInterest = (interest) => {
        setPreferences(prev => 
          prev.includes(interest) 
            ? prev.filter(p => p !== interest)
            : [...prev, interest]
        );
      };

      const handleCitySelect = (city, district) => {
        setSelectedCity(city);
        setSelectedDistrict(district);
        setShowCitySelect(false);
      };

      const handleSavePlan = (plan) => {
        setSavedPlans(prev => {
          const exists = prev.find(p => p.id === plan.id);
          if (exists) {
            return prev.filter(p => p.id !== plan.id);
          } else {
            return [...prev, { ...plan, savedAt: new Date().toISOString() }];
          }
        });
      };

      const generatePlans = () => {
        if (!isFormValid) return;
        setLoading(true);
        setTimeout(() => {
          setLoading(false);
          setPage('plans');
        }, 1000);
      };

      // æ ·å¼
      const styles = {
        container: { background: '#f8f9fb', minHeight: '100vh', paddingBottom: '100px' },
        header: { 
          background: 'rgba(255, 255, 255, 0.95)', 
          backdropFilter: 'saturate(180%) blur(20px)',
          padding: '12px 20px', 
          borderBottom: '0.5px solid rgba(0,0,0,0.05)',
          position: 'sticky', 
          top: 0, 
          zIndex: 100
        },
        logo: { fontSize: '24px', fontWeight: '700', textAlign: 'center', letterSpacing: '-0.5px' },
        content: { padding: '20px 20px 0', maxWidth: '600px', margin: '0 auto' },
        section: { marginBottom: '28px' },
        sectionTitle: {
          fontSize: '20px', fontWeight: '600', color: '#1d1d1f',
          marginBottom: '14px', letterSpacing: '-0.3px'
        },
        button: { 
          padding: '14px 20px', background: '#007aff', color: 'white', 
          border: 'none', borderRadius: '10px', fontSize: '16px', 
          fontWeight: '600', width: '100%', cursor: 'pointer', fontFamily: 'inherit'
        },
        buttonSecondary: { background: '#f2f2f7', color: '#007aff' },
        grid2: { display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '10px' },
        grid3: { display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '10px' },
        modal: { 
          position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, 
          background: 'rgba(0,0,0,0.4)', display: 'flex', alignItems: 'center',
          justifyContent: 'center', padding: '20px', zIndex: 1000
        },
        modalContent: { 
          background: 'white', borderRadius: '16px', padding: '24px 20px', 
          width: '100%', maxWidth: '380px', maxHeight: '80vh', overflowY: 'auto'
        },
        input: { 
          width: '100%', padding: '14px 16px', border: '0.5px solid #d1d1d6', 
          borderRadius: '10px', fontSize: '16px', marginBottom: '12px', 
          outline: 'none', fontFamily: 'inherit', background: 'white'
        },
        bottomBar: { 
          position: 'fixed', bottom: 0, left: 0, right: 0, padding: '16px 20px', 
          background: 'rgba(255, 255, 255, 0.95)', borderTop: '0.5px solid rgba(0,0,0,0.05)'
        }
      };

      // ç»„ä»¶
      const SelectableCard = ({ selected, onClick, children, size = 'medium', disabled = false }) => (
        <div 
          onClick={disabled ? undefined : onClick}
          style={{
            padding: size === 'large' ? '18px' : size === 'small' ? '14px' : '16px',
            borderRadius: '10px', cursor: disabled ? 'not-allowed' : 'pointer',
            border: '0.5px solid', borderColor: selected ? '#007aff' : 'rgba(0,0,0,0.08)',
            background: selected ? '#007aff' : 'white', color: selected ? 'white' : '#1d1d1f',
            opacity: disabled ? 0.5 : 1
          }}
        >
          {children}
        </div>
      );

      const LocationCard = () => (
        <div 
          onClick={() => setShowCitySelect(true)}
          style={{
            background: 'white', borderRadius: '14px', padding: '18px', marginBottom: '20px',
            border: '0.5px solid rgba(0,0,0,0.04)', cursor: 'pointer'
          }}
        >
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '14px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
              <div style={{ fontSize: '18px' }}>ğŸ“</div>
              <div>
                <div style={{ fontSize: '17px', fontWeight: '600', color: '#1d1d1f' }}>
                  {selectedCity} Â· {selectedDistrict}
                </div>
                <div style={{ fontSize: '13px', color: '#86868b', marginTop: '2px' }}>
                  {currentTimeSlot.icon} {currentTimeSlot.label} Â· å½“å‰ä½ç½®
                </div>
              </div>
            </div>
            <div style={{ fontSize: '16px', color: '#007aff' }}>â€º</div>
          </div>
          <div style={{ 
            padding: '10px 14px', background: 'rgba(0, 122, 255, 0.08)', borderRadius: '8px',
            display: 'flex', alignItems: 'center', gap: '10px', fontSize: '14px'
          }}>
            <span>{currentCityData.weather}</span>
            <span style={{ fontWeight: '500', color: '#007aff' }}>{currentCityData.temp}</span>
            <span style={{ color: '#86868b' }}>é€‚å®œå‡ºè¡Œ</span>
            <div style={{ marginLeft: 'auto', display: 'flex', alignItems: 'center', gap: '4px' }}>
              <div className="verification-indicator">âœ“</div>
              <span style={{ fontSize: '12px', color: '#30d158' }}>å®æ—¶éªŒè¯</span>
            </div>
          </div>
        </div>
      );

      const TrustIndicatorBar = () => (
        <div style={{
          background: 'white',
          borderRadius: '12px',
          padding: '16px',
          marginBottom: '20px',
          border: '0.5px solid rgba(0,0,0,0.04)',
          cursor: 'pointer'
        }}
        onClick={() => setShowTrustDetails(true)}
        >
          <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '12px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
              <div style={{ fontSize: '16px' }}>ğŸ›¡ï¸</div>
              <div>
                <div style={{ fontSize: '16px', fontWeight: '600', color: '#1d1d1f' }}>
                  ä¿¡ä»»ä¿éšœä½“ç³»
                </div>
                <div style={{ fontSize: '12px', color: '#86868b' }}>
                  å¤šé‡éªŒè¯ Â· å®æ—¶ç›‘æ§ Â· ä¸“å®¶è®¤è¯
                </div>
              </div>
            </div>
            <div style={{ fontSize: '14px', color: '#007aff' }}>æŸ¥çœ‹è¯¦æƒ… â€º</div>
          </div>
          
          <div style={{ display: 'flex', gap: '8px', marginBottom: '10px' }}>
            <div className="trust-badge">
              <span>ğŸ”´</span> å®æ—¶ç›‘æ§
            </div>
            <div className="trust-badge">
              <span>ğŸ‘¥</span> ä¸“å®¶éªŒè¯
            </div>
            <div className="trust-badge">
              <span>ğŸ“Š</span> æ•°æ®é€æ˜
            </div>
          </div>
          
          <div style={{ 
            background: 'rgba(48, 209, 88, 0.1)', 
            borderRadius: '6px', 
            padding: '8px 12px',
            fontSize: '12px',
            color: '#30d158',
            fontWeight: '500'
          }}>
            ğŸŒŸ ç”¨æˆ·æ»¡æ„åº¦ {CONFIG.trustIndicators.userFeedback.satisfaction}% Â· æœˆæ´»è·ƒç”¨æˆ· {CONFIG.trustIndicators.userFeedback.monthlyActive.toLocaleString()}
          </div>
        </div>
      );

      const DataSourceBadges = ({ dataSources, lastUpdated, realTimeStatus }) => {
        const sourceConfig = CONFIG.dataSources;
        const allSources = [...sourceConfig.external, ...sourceConfig.internal];
        
        return (
          <div style={{ marginBottom: '10px' }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '6px', marginBottom: '6px' }}>
              <span style={{ fontSize: '11px', color: '#86868b' }}>æ•°æ®æ¥æº:</span>
              {dataSources.map(sourceName => {
                const source = allSources.find(s => s.name === sourceName);
                return source ? (
                  <div key={sourceName} style={{
                    display: 'flex', alignItems: 'center', gap: '3px',
                    background: 'rgba(0, 122, 255, 0.08)', padding: '2px 6px',
                    borderRadius: '10px', fontSize: '10px', color: '#007aff'
                  }}>
                    <span>{source.logo}</span>
                    <span>{source.name}</span>
                    <span style={{ 
                      fontSize: '8px', 
                      background: '#30d158', 
                      color: 'white', 
                      padding: '1px 3px', 
                      borderRadius: '2px',
                      marginLeft: '2px'
                    }}>
                      {source.trustScore}
                    </span>
                  </div>
                ) : null;
              })}
            </div>
            <div style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '10px', color: '#86868b' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }}>
                <span style={{ 
                  width: '6px', 
                  height: '6px', 
                  borderRadius: '50%', 
                  background: realTimeStatus === 'open' ? '#30d158' : '#ff3b30' 
                }}></span>
                ğŸ“„ æ›´æ–°äº {lastUpdated}
              </div>
              {realTimeStatus && (
                <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }}>
                  <span style={{ 
                    width: '6px', 
                    height: '6px', 
                    borderRadius: '50%', 
                    background: '#30d158',
                    animation: 'pulse 2s infinite'
                  }}></span>
                  å®æ—¶çŠ¶æ€: {realTimeStatus === 'open' ? 'æ­£å¸¸è¥ä¸š' : 'æš‚åœè¥ä¸š'}
                </div>
              )}
            </div>
          </div>
        );
      };

      const AiScoreDisplay = ({ aiScore, userFeedback, staffVerified, expertReview, safetyChecks }) => {
        const getScoreColor = (score) => {
          if (score >= 90) return '#30d158';
          if (score >= 80) return '#ff9500';
          return '#ff3b30';
        };

        const getScoreLevel = (score) => {
          if (score >= 90) return 'æåŠ›æ¨è';
          if (score >= 80) return 'å€¼å¾—ä¸€å»';
          return 'ä¸€èˆ¬æ¨è';
        };

        return (
          <div style={{
            background: 'linear-gradient(135deg, rgba(0, 122, 255, 0.05), rgba(0, 122, 255, 0.1))',
            borderRadius: '8px', padding: '10px', marginBottom: '12px',
            border: '0.5px solid rgba(0, 122, 255, 0.2)'
          }}>
            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '6px' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                <span style={{ fontSize: '12px', fontWeight: '600', color: '#007aff' }}>ğŸ¤– FunGo AIè¯„åˆ†</span>
                {staffVerified && (
                  <span className="trust-badge">
                    âœ“ å‘˜å·¥è®¤è¯
                  </span>
                )}
                {expertReview && (
                  <span className="trust-badge">
                    ğŸ‘¨â€âš•ï¸ ä¸“å®¶éªŒè¯
                  </span>
                )}
              </div>
              <div style={{ fontSize: '18px', fontWeight: '700', color: getScoreColor(aiScore) }}>
                {aiScore}
              </div>
            </div>
            
            <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '8px' }}>
              <span style={{ fontSize: '11px', color: getScoreColor(aiScore), fontWeight: '500' }}>
                {getScoreLevel(aiScore)}
              </span>
              <div style={{ display: 'flex', alignItems: 'center', gap: '8px', fontSize: '10px', color: '#86868b' }}>
                <span>ğŸ‘ {userFeedback.likes}</span>
                <span>ğŸ‘ {userFeedback.dislikes}</span>
                <span style={{ color: '#30d158' }}>
                  {Math.round((userFeedback.likes / (userFeedback.likes + userFeedback.dislikes)) * 100)}% å¥½è¯„
                </span>
              </div>
            </div>

            {expertReview && (
              <div style={{ 
                background: 'rgba(48, 209, 88, 0.1)', 
                borderRadius: '4px', 
                padding: '6px 8px',
                fontSize: '10px',
                color: '#30d158',
                marginBottom: '6px'
              }}>
                ğŸ‘¨â€âš•ï¸ ä¸“å®¶ {expertReview.reviewer} è¯„åˆ†: {expertReview.score}/10 ({expertReview.date})
              </div>
            )}

            {safetyChecks && (
              <div style={{ fontSize: '9px', color: '#86868b', lineHeight: '1.3' }}>
                ğŸ›¡ï¸ å®‰å…¨æ£€æŸ¥: {safetyChecks.lastInspection} Â· 
                {safetyChecks.issues === 0 ? ' æ— å®‰å…¨éšæ‚£' : ` ${safetyChecks.issues}ä¸ªéšæ‚£`} Â· 
                {safetyChecks.certified ? ' å®‰å…¨è®¤è¯' : ' å¾…è®¤è¯'}
              </div>
            )}
          </div>
        );
      };

      const RecommendReasons = ({ reasons }) => {
        if (!reasons || reasons.length === 0) return null;
        
        return (
          <div style={{ marginBottom: '10px' }}>
            <div style={{ fontSize: '12px', color: '#86868b', marginBottom: '4px' }}>
              ğŸ’¡ æ¨èç†ç”±:
            </div>
            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '4px' }}>
              {reasons.map((reason, index) => (
                <span key={index} style={{
                  background: 'rgba(48, 209, 88, 0.1)', color: '#30d158',
                  padding: '2px 6px', borderRadius: '4px', fontSize: '10px',
                  fontWeight: '500', border: '0.5px solid rgba(48, 209, 88, 0.3)'
                }}>
                  {reason}
                </span>
              ))}
            </div>
          </div>
        );
      };

      const RealTimeStatusIndicator = ({ status, crowdLevel, lastUpdate }) => (
        <div style={{
          background: status === 'open' ? 'rgba(48, 209, 88, 0.1)' : 'rgba(255, 59, 48, 0.1)',
          border: `0.5px solid ${status === 'open' ? 'rgba(48, 209, 88, 0.3)' : 'rgba(255, 59, 48, 0.3)'}`,
          borderRadius: '6px',
          padding: '6px 8px',
          marginBottom: '8px',
          fontSize: '11px'
        }}>
          <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
            <div style={{
              width: '6px',
              height: '6px',
              borderRadius: '50%',
              background: status === 'open' ? '#30d158' : '#ff3b30',
              animation: 'pulse 2s infinite'
            }}></div>
            <span style={{ fontWeight: '600', color: status === 'open' ? '#30d158' : '#ff3b30' }}>
              {status === 'open' ? 'ğŸŸ¢ æ­£å¸¸è¥ä¸š' : 'ğŸ”´ æš‚åœè¥ä¸š'}
            </span>
            <span style={{ color: '#86868b' }}>Â·</span>
            <span style={{ color: '#86868b' }}>
              äººæµ: {crowdLevel === 'low' ? 'è¾ƒå°‘' : crowdLevel === 'moderate' ? 'é€‚ä¸­' : 'è¾ƒå¤š'}
            </span>
          </div>
          <div style={{ fontSize: '9px', color: '#86868b', marginTop: '2px' }}>
            å®æ—¶æ•°æ®æ›´æ–°äº {lastUpdate || 'åˆšåˆš'}
          </div>
        </div>
      );

      const LocalPlanCard = ({ plan, onSave, isSaved, onPreview }) => (
        <div style={{
          background: 'white',
          borderRadius: '14px',
          overflow: 'hidden',
          marginBottom: '14px',
          border: '0.5px solid rgba(0,0,0,0.04)',
          boxShadow: '0 2px 8px rgba(0,0,0,0.04)'
        }}>
          {plan.timeRecommend && (
            <div style={{
              background: 'linear-gradient(135deg, #30d158, #34c759)',
              color: 'white',
              padding: '8px 14px',
              fontSize: '12px',
              fontWeight: '600',
              display: 'flex',
              alignItems: 'center',
              gap: '6px'
            }}>
              {currentTimeSlot.icon} {plan.timeRecommend}æ¨è
            </div>
          )}
          
          <div style={{ padding: '16px' }}>
            <div style={{ marginBottom: '12px' }}>
              <h3 style={{ fontSize: '17px', fontWeight: '600', color: '#1d1d1f', marginBottom: '4px' }}>
                {plan.title}
              </h3>
              <p style={{ fontSize: '13px', color: '#86868b' }}>
                {plan.subtitle}
              </p>
            </div>

            <RealTimeStatusIndicator 
              status={plan.realTimeStatus} 
              crowdLevel={plan.crowdLevel}
              lastUpdate={plan.lastUpdated}
            />

            <DataSourceBadges 
              dataSources={plan.dataSources} 
              lastUpdated={plan.lastUpdated}
              realTimeStatus={plan.realTimeStatus}
            />
            
            <AiScoreDisplay 
              aiScore={plan.aiScore} 
              userFeedback={plan.userFeedback} 
              staffVerified={plan.staffVerified}
              expertReview={plan.expertReview}
              safetyChecks={plan.safetyChecks}
            />
            
            <RecommendReasons reasons={plan.recommendReasons} />
            
            <div style={{ display: 'flex', alignItems: 'center', gap: '12px', marginBottom: '10px' }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                <span style={{ fontSize: '13px', color: '#86868b' }}>ç”¨æˆ·è¯„åˆ†</span>
                <span style={{ fontSize: '14px', fontWeight: '500', color: '#1d1d1f' }}>{plan.rating}</span>
                <span style={{ fontSize: '12px', color: '#ffa726' }}>â­</span>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '4px' }}>
                <span style={{ fontSize: '13px', color: '#86868b' }}>å® ç‰©å‹å¥½</span>
                <div style={{ display: 'flex', gap: '1px' }}>
                  {[1,2,3,4,5].map(i => (
                    <span key={i} style={{ 
                      fontSize: '10px', 
                      color: i <= plan.petFriendly ? '#007aff' : '#e0e0e0' 
                    }}>
                      ğŸ¾
                    </span>
                  ))}
                </div>
              </div>
            </div>
            
            <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px', marginBottom: '12px' }}>
              {plan.features?.map((feature, idx) => (
                <span key={idx} style={{
                  background: 'rgba(0, 122, 255, 0.08)',
                  color: '#007aff',
                  padding: '3px 8px',
                  borderRadius: '4px',
                  fontSize: '11px',
                  fontWeight: '500'
                }}>
                  {feature}
                </span>
              ))}
            </div>
            
            <div style={{ display: 'flex', gap: '8px' }}>
              <button
                onClick={() => onPreview(plan)}
                style={{
                  flex: 1,
                  padding: '10px',
                  background: '#f2f2f7',
                  color: '#007aff',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                é¢„è§ˆè¯¦æƒ…
              </button>
              <button
                onClick={() => onSave(plan)}
                style={{
                  padding: '10px 16px',
                  background: isSaved ? '#30d158' : '#007aff',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                {isSaved ? 'âœ“ å·²æ”¶è—' : 'æ”¶è—'}
              </button>
            </div>
          </div>
        </div>
      );

      const TrustDetailsModal = () => (
        <div style={styles.modal} onClick={(e) => e.target === e.currentTarget && setShowTrustDetails(false)}>
          <div style={{...styles.modalContent, maxWidth: '500px'}}>
            <div style={{ 
              display: 'flex', 
              justifyContent: 'space-between', 
              alignItems: 'center', 
              marginBottom: '20px',
              paddingBottom: '12px',
              borderBottom: '0.5px solid rgba(0,0,0,0.05)'
            }}>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1d1d1f' }}>ä¿¡ä»»ä¿éšœä½“ç³»</h3>
              <button 
                onClick={() => setShowTrustDetails(false)} 
                style={{ 
                  background: 'none', 
                  border: 'none', 
                  fontSize: '24px', 
                  color: '#86868b',
                  cursor: 'pointer'
                }}
              >
                Ã—
              </button>
            </div>
            
            <div style={{ maxHeight: '70vh', overflowY: 'auto' }}>
              {/* å®æ—¶ç›‘æ§ */}
              <div style={{ marginBottom: '20px' }}>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  ğŸ”´ å®æ—¶ç›‘æ§ç³»ç»Ÿ
                </h4>
                <div style={{ fontSize: '14px', color: '#86868b', lineHeight: '1.5', marginBottom: '8px' }}>
                  24/7 ç›‘æ§æ‰€æœ‰æ¨èåœºæ‰€çš„è¥ä¸šçŠ¶æ€ã€äººæµå¯†åº¦ã€å¤©æ°”å½±å“ç­‰å®æ—¶ä¿¡æ¯
                </div>
                <div style={{ background: '#f8f9fb', borderRadius: '6px', padding: '8px', fontSize: '12px' }}>
                  <div>â€¢ è¥ä¸šçŠ¶æ€: æ¯5åˆ†é’Ÿæ›´æ–°</div>
                  <div>â€¢ äººæµç›‘æ§: åŸºäºå¤šå¹³å°æ•°æ®å®æ—¶åˆ†æ</div>
                  <div>â€¢ å¤©æ°”é¢„è­¦: è‡ªåŠ¨æé†’ä¸é€‚å®œæˆ·å¤–æ´»åŠ¨</div>
                  <div>â€¢ å®‰å…¨æé†’: å‘ç°é—®é¢˜ç«‹å³æ¨é€è­¦å‘Š</div>
                </div>
              </div>

              {/* ä¸“å®¶å›¢é˜Ÿ */}
              <div style={{ marginBottom: '20px' }}>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  ğŸ‘¥ ä¸“å®¶éªŒè¯å›¢é˜Ÿ
                </h4>
                <div style={{ fontSize: '14px', color: '#86868b', lineHeight: '1.5', marginBottom: '8px' }}>
                  ç”±ä¸“ä¸šå® ç‰©ä¸“å®¶ã€æ—…æ¸¸è§„åˆ’å¸ˆå®åœ°éªŒè¯æ¯ä¸ªæ¨èåœºæ‰€
                </div>
                {CONFIG.trustIndicators.expertVerification.team.map((expert, index) => (
                  <div key={index} style={{ 
                    background: '#f8f9fb', 
                    borderRadius: '6px', 
                    padding: '8px', 
                    marginBottom: '6px',
                    fontSize: '12px'
                  }}>
                    <div style={{ fontWeight: '600', marginBottom: '2px' }}>
                      {expert.name} - {expert.role}
                    </div>
                    <div style={{ color: '#86868b' }}>
                      {expert.cert} Â· {expert.years}å¹´ç»éªŒ
                    </div>
                  </div>
                ))}
              </div>

              {/* æ•°æ®é€æ˜ */}
              <div style={{ marginBottom: '20px' }}>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  ğŸ“Š æ•°æ®æ¥æºé€æ˜
                </h4>
                <div style={{ fontSize: '14px', color: '#86868b', lineHeight: '1.5', marginBottom: '8px' }}>
                  æ¸…æ¥šå±•ç¤ºæ¯ä¸ªæ¨èçš„æ•°æ®æ¥æºã€æ›´æ–°æ—¶é—´ã€å¯ä¿¡åº¦è¯„åˆ†
                </div>
                <div style={{ display: 'grid', gap: '6px' }}>
                  {[...CONFIG.dataSources.external, ...CONFIG.dataSources.internal].map((source, index) => (
                    <div key={index} style={{ 
                      background: '#f8f9fb', 
                      borderRadius: '6px', 
                      padding: '8px',
                      fontSize: '12px',
                      display: 'flex',
                      justifyContent: 'space-between',
                      alignItems: 'center'
                    }}>
                      <div>
                        <span>{source.logo}</span> {source.name} 
                        <span style={{ color: '#86868b', marginLeft: '6px' }}>
                          ({source.sampleSize})
                        </span>
                      </div>
                      <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                        <span style={{ color: '#30d158', fontWeight: '600' }}>
                          {source.trustScore}
                        </span>
                        <span style={{ fontSize: '10px', color: '#86868b' }}>
                          æƒé‡{source.weight}%
                        </span>
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* ç”¨æˆ·åé¦ˆ */}
              <div style={{ marginBottom: '20px' }}>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  â­ ç”¨æˆ·æ»¡æ„åº¦
                </h4>
                <div style={{
                  background: 'linear-gradient(135deg, rgba(48, 209, 88, 0.1), rgba(52, 199, 89, 0.05))',
                  borderRadius: '8px',
                  padding: '12px',
                  textAlign: 'center'
                }}>
                  <div style={{ fontSize: '24px', fontWeight: '700', color: '#30d158', marginBottom: '4px' }}>
                    {CONFIG.trustIndicators.userFeedback.satisfaction}%
                  </div>
                  <div style={{ fontSize: '14px', color: '#1d1d1f', fontWeight: '500' }}>
                    ç”¨æˆ·æ»¡æ„åº¦
                  </div>
                  <div style={{ fontSize: '12px', color: '#86868b', marginTop: '6px' }}>
                    åŸºäº {CONFIG.trustIndicators.userFeedback.totalUsers.toLocaleString()} ç”¨æˆ·åé¦ˆ
                  </div>
                </div>
              </div>

              {/* å®‰å…¨ä¿éšœ */}
              <div>
                <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px', color: '#1d1d1f' }}>
                  ğŸ›¡ï¸ å®‰å…¨ä¿éšœæ‰¿è¯º
                </h4>
                <div style={{ fontSize: '13px', color: '#86868b', lineHeight: '1.5' }}>
                  <div>â€¢ æ‰€æœ‰æ¨èåœºæ‰€å‡ç»è¿‡å®‰å…¨æ£€æŸ¥è®¤è¯</div>
                  <div>â€¢ å® ç‰©å‹å¥½åº¦ç”±ä¸“ä¸šå…½åŒ»å›¢é˜Ÿè¯„ä¼°</div>
                  <div>â€¢ æä¾›24å°æ—¶å®¢æœæ”¯æŒå’Œåº”æ€¥è”ç³»</div>
                  <div>â€¢ å‘ç°é—®é¢˜ç«‹å³ä¸‹æ¶å¹¶è¡¥å¿ç”¨æˆ·æŸå¤±</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      );

      const TravelPlanCard = ({ plan, onSave, isSaved, onPreview, onBookHotel }) => (
        <div style={{
          background: 'white',
          borderRadius: '14px',
          overflow: 'hidden',
          marginBottom: '14px',
          border: '0.5px solid rgba(0,0,0,0.04)',
          boxShadow: '0 2px 8px rgba(0,0,0,0.04)'
        }}>
          <div style={{
            background: 'linear-gradient(135deg, #007aff, #5ac8fa)',
            padding: '16px',
            color: 'white'
          }}>
            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
              <div style={{ fontSize: '32px' }}>{plan.hotel.image}</div>
              <div style={{ flex: 1 }}>
                <h3 style={{ fontSize: '17px', fontWeight: '600', marginBottom: '4px' }}>
                  {plan.hotel.name}
                </h3>
                <div style={{ fontSize: '13px', opacity: 0.9 }}>
                  {plan.title}
                </div>
              </div>
            </div>
          </div>
          
          <div style={{ padding: '16px' }}>
            {/* é…’åº—è®¤è¯ä¿¡æ¯ */}
            <div style={{ display: 'flex', gap: '6px', marginBottom: '12px' }}>
              {plan.hotel.license === 'verified' && (
                <span className="trust-badge">âœ“ è¥ä¸šæ‰§ç…§</span>
              )}
              {plan.hotel.insurance && (
                <span className="trust-badge">ğŸ›¡ï¸ {plan.hotel.insurance}ä¿é™©</span>
              )}
              {plan.hotel.staffTrained && (
                <span className="trust-badge">ğŸ‘¨â€ğŸ“ å‘˜å·¥åŸ¹è®­</span>
              )}
              {plan.hotel.superhost && (
                <span className="trust-badge">â­ è¶…çº§æˆ¿ä¸œ</span>
              )}
            </div>

            <div style={{
              background: 'rgba(255, 149, 0, 0.1)',
              borderRadius: '8px',
              padding: '10px',
              marginBottom: '12px',
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center'
            }}>
              <div>
                <div style={{ fontSize: '20px', fontWeight: '700', color: '#ff9500' }}>
                  Â¥{plan.totalPrice}
                </div>
                <div style={{ fontSize: '12px', color: '#86868b' }}>
                  {plan.subtitle}
                </div>
              </div>
              <div style={{ display: 'flex', alignItems: 'center', gap: '2px' }}>
                {[1,2,3,4,5].map(i => (
                  <span key={i} style={{ 
                    fontSize: '12px', 
                    color: i <= plan.rating ? '#ffa726' : '#e0e0e0' 
                  }}>â­</span>
                ))}
              </div>
            </div>
            
            <div style={{ marginBottom: '12px' }}>
              <div style={{ fontSize: '14px', fontWeight: '500', color: '#1d1d1f', marginBottom: '6px' }}>
                é…’åº—ç‰¹è‰²
              </div>
              <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>
                {plan.features?.map((feature, idx) => (
                  <span key={idx} style={{
                    background: 'rgba(0, 122, 255, 0.08)',
                    color: '#007aff',
                    padding: '3px 8px',
                    borderRadius: '4px',
                    fontSize: '11px',
                    fontWeight: '500'
                  }}>
                    {feature}
                  </span>
                ))}
              </div>
            </div>
            
            <div style={{ marginBottom: '12px' }}>
              <div style={{ fontSize: '14px', fontWeight: '500', color: '#1d1d1f', marginBottom: '6px' }}>
                å‘¨è¾¹æ™¯ç‚¹
              </div>
              <div style={{ fontSize: '12px', color: '#86868b', lineHeight: '1.5' }}>
                {plan.places?.map(p => p.name).join(' Â· ')}
              </div>
            </div>
            
            <div style={{ display: 'flex', gap: '8px' }}>
              <button
                onClick={() => onPreview(plan)}
                style={{
                  flex: 1,
                  padding: '10px',
                  background: '#f2f2f7',
                  color: '#007aff',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                é¢„è§ˆè¡Œç¨‹
              </button>
              <button
                onClick={() => onBookHotel(plan.hotel)}
                style={{
                  flex: 1,
                  padding: '10px',
                  background: '#ff9500',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                ä¸€é”®é¢„è®¢
              </button>
              <button
                onClick={() => onSave(plan)}
                style={{
                  padding: '10px 16px',
                  background: isSaved ? '#30d158' : '#007aff',
                  color: 'white',
                  border: 'none',
                  borderRadius: '8px',
                  fontSize: '14px',
                  fontWeight: '500',
                  cursor: 'pointer'
                }}
              >
                {isSaved ? 'âœ“' : 'æ”¶è—'}
              </button>
            </div>
          </div>
        </div>
      );

      const MapView = ({ places, onClose }) => (
        <div style={{
          position: 'fixed',
          top: 0,
          left: 0,
          right: 0,
          bottom: 0,
          background: 'white',
          zIndex: 2000
        }}>
          <div style={{
            position: 'absolute',
            top: 0,
            left: 0,
            right: 0,
            background: 'rgba(255, 255, 255, 0.95)',
            padding: '12px 20px',
            borderBottom: '0.5px solid rgba(0,0,0,0.05)',
            zIndex: 10,
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'space-between'
          }}>
            <button
              onClick={onClose}
              style={{
                background: 'none',
                border: 'none',
                fontSize: '16px',
                color: '#007aff',
                cursor: 'pointer',
                padding: '4px'
              }}
            >
              å®Œæˆ
            </button>
            <div style={{ fontSize: '17px', fontWeight: '600' }}>åœ°å›¾è§†å›¾</div>
            <div style={{ width: '40px' }}></div>
          </div>
          
          <div style={{
            width: '100%',
            height: '100%',
            background: 'linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)',
            position: 'relative',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'center'
          }}>
            <div style={{
              fontSize: '48px',
              color: '#007aff',
              textAlign: 'center'
            }}>
              ğŸ—ºï¸
              <div style={{ fontSize: '16px', marginTop: '12px', color: '#1d1d1f' }}>
                åœ°å›¾åŠ è½½ä¸­...
              </div>
            </div>
            
            {places?.map((place, index) => (
              <div
                key={place.id || index}
                style={{
                  position: 'absolute',
                  left: `${20 + (index * 25)}%`,
                  top: `${30 + (index * 15)}%`,
                  background: '#007aff',
                  color: 'white',
                  padding: '6px 10px',
                  borderRadius: '20px',
                  fontSize: '12px',
                  fontWeight: '500',
                  boxShadow: '0 2px 8px rgba(0,0,0,0.2)'
                }}
              >
                {index + 1} {place.name}
              </div>
            ))}
          </div>
        </div>
      );

      const PlanPreview = ({ plan, onClose, onSave, isSaved }) => {
        const places = plan.type === 'local' ? [plan.place] : plan.places;
        
        return (
          <div style={styles.modal}>
            <div style={{
              ...styles.modalContent,
              maxWidth: '500px',
              maxHeight: '90vh'
            }}>
              <div style={{ 
                display: 'flex', 
                justifyContent: 'space-between', 
                alignItems: 'center', 
                marginBottom: '20px',
                paddingBottom: '12px',
                borderBottom: '0.5px solid rgba(0,0,0,0.05)'
              }}>
                <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1d1d1f' }}>
                  {plan.type === 'local' ? 'æ´»åŠ¨è¯¦æƒ…' : 'è¡Œç¨‹é¢„è§ˆ'}
                </h3>
                <button 
                  onClick={onClose} 
                  style={{ 
                    background: 'none', 
                    border: 'none', 
                    fontSize: '24px', 
                    color: '#86868b',
                    cursor: 'pointer'
                  }}
                >
                  Ã—
                </button>
              </div>
              
              <div 
                onClick={() => setShowMapView(true)}
                style={{
                  height: '120px',
                  background: 'linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%)',
                  borderRadius: '10px',
                  marginBottom: '16px',
                  display: 'flex',
                  alignItems: 'center',
                  justifyContent: 'center',
                  cursor: 'pointer',
                  position: 'relative',
                  overflow: 'hidden'
                }}
              >
                <div style={{ textAlign: 'center', zIndex: 1 }}>
                  <div style={{ fontSize: '32px', marginBottom: '4px' }}>ğŸ—ºï¸</div>
                  <div style={{ fontSize: '12px', color: '#007aff', fontWeight: '500' }}>
                    ç‚¹å‡»æŸ¥çœ‹åœ°å›¾
                  </div>
                </div>
                {places?.slice(0, 3).map((place, index) => (
                  <div
                    key={index}
                    style={{
                      position: 'absolute',
                      left: `${15 + (index * 30)}%`,
                      top: `${20 + (index * 20)}%`,
                      width: '8px',
                      height: '8px',
                      background: '#007aff',
                      borderRadius: '50%',
                      border: '2px solid white',
                      boxShadow: '0 2px 4px rgba(0,0,0,0.2)'
                    }}
                  />
                ))}
              </div>
              
              {plan.type === 'local' ? (
                <div>
                  <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px' }}>
                    {plan.place.name}
                  </h4>
                  
                  {/* ä¿¡ä»»æŒ‡æ ‡å±•ç¤º */}
                  <div style={{ marginBottom: '12px' }}>
                    {plan.place.staffVerified && (
                      <div className="trust-badge" style={{ marginRight: '6px', marginBottom: '4px' }}>
                        âœ“ å‘˜å·¥å®åœ°éªŒè¯
                      </div>
                    )}
                    {plan.place.expertReview && (
                      <div className="trust-badge" style={{ marginRight: '6px', marginBottom: '4px' }}>
                        ğŸ‘¨â€âš•ï¸ ä¸“å®¶è®¤è¯
                      </div>
                    )}
                    {plan.place.safetyChecks?.certified && (
                      <div className="trust-badge" style={{ marginBottom: '4px' }}>
                        ğŸ›¡ï¸ å®‰å…¨è®¤è¯
                      </div>
                    )}
                  </div>

                  <div style={{ fontSize: '13px', color: '#86868b', lineHeight: '1.5', marginBottom: '12px' }}>
                    <div>ğŸ“ è·ç¦»: {plan.place.distance}km</div>
                    <div>â° å¼€æ”¾æ—¶é—´: {plan.place.time}</div>
                    <div>â­ è¯„åˆ†: {plan.place.rating}</div>
                    <div>ğŸ¾ å® ç‰©å‹å¥½åº¦: {'ğŸ¾'.repeat(plan.place.petFriendly)}</div>
                    {plan.place.realTimeStatus && (
                      <div style={{ marginTop: '6px' }}>
                        <span style={{ 
                          color: plan.place.realTimeStatus === 'open' ? '#30d158' : '#ff3b30',
                          fontWeight: '500'
                        }}>
                          ğŸ”´ {plan.place.realTimeStatus === 'open' ? 'æ­£å¸¸è¥ä¸š' : 'æš‚åœè¥ä¸š'}
                        </span>
                        <span style={{ marginLeft: '8px' }}>
                          äººæµ: {plan.place.crowdLevel === 'low' ? 'è¾ƒå°‘' : 
                               plan.place.crowdLevel === 'moderate' ? 'é€‚ä¸­' : 'è¾ƒå¤š'}
                        </span>
                      </div>
                    )}
                  </div>
                  
                  {plan.place.expertReview && (
                    <div style={{
                      background: 'rgba(48, 209, 88, 0.1)',
                      borderRadius: '6px',
                      padding: '8px',
                      marginBottom: '12px',
                      fontSize: '12px'
                    }}>
                      <div style={{ fontWeight: '600', color: '#30d158', marginBottom: '2px' }}>
                        ğŸ‘¨â€âš•ï¸ ä¸“å®¶è¯„ä»·
                      </div>
                      <div style={{ color: '#86868b' }}>
                        {plan.place.expertReview.reviewer} è¯„åˆ†: {plan.place.expertReview.score}/10
                      </div>
                      <div style={{ color: '#86868b' }}>
                        è¯„ä»·æ—¥æœŸ: {plan.place.expertReview.date}
                      </div>
                    </div>
                  )}

                  <div style={{ marginBottom: '12px' }}>
                    <div style={{ fontSize: '14px', fontWeight: '500', marginBottom: '6px' }}>ç‰¹è‰²</div>
                    <div style={{ display: 'flex', flexWrap: 'wrap', gap: '6px' }}>
                      {plan.place.features?.map((f, i) => (
                        <span key={i} style={{
                          background: 'rgba(0, 122, 255, 0.08)',
                          color: '#007aff',
                          padding: '3px 8px',
                          borderRadius: '4px',
                          fontSize: '11px'
                        }}>{f}</span>
                      ))}
                    </div>
                  </div>
                </div>
              ) : (
                <div>
                  <div style={{ marginBottom: '16px' }}>
                    <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px' }}>
                      ä½å®¿å®‰æ’
                    </h4>
                    <div style={{
                      background: '#f8f9fb',
                      borderRadius: '8px',
                      padding: '12px'
                    }}>
                      <div style={{ fontSize: '15px', fontWeight: '500', marginBottom: '4px' }}>
                        {plan.hotel.name}
                      </div>
                      <div style={{ fontSize: '13px', color: '#86868b' }}>
                        Â¥{plan.hotel.price}/æ™š Â· å® ç‰©è´¹ Â¥{plan.hotel.petFee}
                      </div>
                    </div>
                  </div>
                  
                  <div>
                    <h4 style={{ fontSize: '16px', fontWeight: '600', marginBottom: '8px' }}>
                      è¡Œç¨‹å®‰æ’
                    </h4>
                    {places?.map((place, index) => (
                      <div key={index} style={{
                        background: '#f8f9fb',
                        borderRadius: '8px',
                        padding: '12px',
                        marginBottom: '8px'
                      }}>
                        <div style={{ fontSize: '14px', fontWeight: '500', marginBottom: '4px' }}>
                          Day {Math.floor(index / 2) + 1} - {place.name}
                        </div>
                        <div style={{ fontSize: '12px', color: '#86868b' }}>
                          è·ç¦» {place.distance}km Â· {place.time}
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}
              
              <div style={{ marginTop: '20px', paddingTop: '16px', borderTop: '0.5px solid rgba(0,0,0,0.05)' }}>
                <button
                  onClick={() => onSave(plan)}
                  style={{
                    ...styles.button,
                    background: isSaved ? '#30d158' : '#007aff'
                  }}
                >
                  {isSaved ? 'âœ“ å·²æ”¶è—åˆ°è¡Œç¨‹' : 'æ”¶è—åˆ°æˆ‘çš„è¡Œç¨‹'}
                </button>
              </div>
            </div>
          </div>
        );
      };

      // åŸå¸‚é€‰æ‹©æ¨¡æ€æ¡†ç»„ä»¶
      const CitySelectModal = () => (
        <div style={styles.modal} onClick={(e) => e.target === e.currentTarget && setShowCitySelect(false)}>
          <div style={styles.modalContent}>
            <div style={{ 
              display: 'flex', 
              justifyContent: 'space-between', 
              alignItems: 'center', 
              marginBottom: '20px',
              paddingBottom: '12px',
              borderBottom: '0.5px solid rgba(0,0,0,0.05)'
            }}>
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1d1d1f' }}>é€‰æ‹©ä½ç½®</h3>
              <button 
                onClick={() => setShowCitySelect(false)} 
                style={{ 
                  background: 'none', 
                  border: 'none', 
                  fontSize: '22px', 
                  color: '#86868b',
                  cursor: 'pointer'
                }}
              >
                Ã—
              </button>
            </div>
            
            <div style={{ maxHeight: '60vh', overflowY: 'auto' }}>
              {CONFIG.cities.major.map(city => (
                <div key={city.name} style={{ marginBottom: '16px' }}>
                  <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '10px', color: '#1d1d1f', display: 'flex', alignItems: 'center', gap: '8px' }}>
                    {city.name} 
                    <span style={{ fontSize: '13px', color: '#86868b' }}>{city.weather} {city.temp}</span>
                  </div>
                  <div style={{ display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '8px' }}>
                    {city.districts.map(district => (
                      <button
                        key={district}
                        onClick={() => handleCitySelect(city.name, district)}
                        style={{
                          padding: '12px 14px',
                          background: selectedCity === city.name && selectedDistrict === district 
                            ? '#007aff' 
                            : 'white',
                          color: selectedCity === city.name && selectedDistrict === district ? 'white' : '#1d1d1f',
                          border: '0.5px solid',
                          borderColor: selectedCity === city.name && selectedDistrict === district ? '#007aff' : 'rgba(0,0,0,0.08)',
                          borderRadius: '8px',
                          fontSize: '14px',
                          fontWeight: '500',
                          cursor: 'pointer',
                          fontFamily: 'inherit'
                        }}
                      >
                        {district}
                      </button>
                    ))}
                  </div>
                </div>
              ))}
            </div>
          </div>
        </div>
      );

      // ä¸»æ¸²æŸ“
      if (page === 'planning') {
        return (
          <div style={styles.container} className={animationClass}>
            <div style={styles.header}>
              <div style={styles.logo}>
                <span style={{ color: '#1d1d1f' }}>Fun</span>
                <span style={{ color: '#007aff' }}>Go</span>
              </div>
            </div>

            <div style={styles.content}>
              {/* ä¿¡ä»»æŒ‡æ ‡å±•ç¤º */}
              <TrustIndicatorBar />

              <div style={styles.section}>
                <div style={styles.sectionTitle}>ä»Šå¤©æƒ³åšä»€ä¹ˆï¼Ÿ</div>
                <div style={styles.grid2}>
                  {[
                    { type: 'local', icon: 'ğŸ¯', label: 'æ‰¾äº‹åš', desc: 'é™„è¿‘æ´»åŠ¨' },
                    { type: 'travel', icon: 'ğŸ“…', label: 'è§„åˆ’æ¸¸', desc: 'å¤šæ—¥è¡Œç¨‹' }
                  ].map(item => (
                    <SelectableCard 
                      key={item.type}
                      selected={tripType === item.type}
                      onClick={() => handleTripTypeChange(item.type)}
                      size="large"
                    >
                      <div style={{ textAlign: 'center' }}>
                        <div style={{ fontSize: '28px', marginBottom: '10px' }}>{item.icon}</div>
                        <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '3px' }}>
                          {item.label}
                        </div>
                        <div style={{ fontSize: '12px', opacity: 0.7 }}>{item.desc}</div>
                      </div>
                    </SelectableCard>
                  ))}
                </div>
              </div>

              <div style={styles.section}>
                <div style={styles.sectionTitle}>
                  {tripType === 'local' ? 'æˆ‘åœ¨å“ªé‡Œ' : 'å»å“ªé‡Œç©'}
                </div>
                <LocationCard />
                
                {tripType === 'local' && (
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '12px', color: '#1d1d1f' }}>
                      æˆ‘çš„å…´è¶£
                    </div>
                    <div style={styles.grid3}>
                      {CONFIG.interests.map(item => (
                        <SelectableCard 
                          key={item.id}
                          selected={preferences.includes(item.label)}
                          onClick={() => handleToggleInterest(item.label)}
                          size="small"
                        >
                          <div style={{ textAlign: 'center' }}>
                            <div style={{ fontSize: '20px', marginBottom: '6px' }}>{item.icon}</div>
                            <div style={{ fontSize: '11px', fontWeight: '500', lineHeight: '1.2' }}>
                              {item.label}
                            </div>
                          </div>
                        </SelectableCard>
                      ))}
                    </div>
                  </div>
                )}
                
                {tripType === 'travel' && (
                  <div>
                    <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '12px', color: '#1d1d1f' }}>
                      å‡ºè¡Œå¤©æ•°
                    </div>
                    <div style={styles.grid2}>
                      {CONFIG.durations.map(item => (
                        <SelectableCard 
                          key={item.value}
                          selected={duration === item.value}
                          onClick={() => setDuration(item.value)}
                        >
                          <div>
                            <div style={{ fontWeight: '600', fontSize: '16px', marginBottom: '3px' }}>
                              {item.label}
                            </div>
                            <div style={{ fontSize: '12px', opacity: 0.7 }}>
                              {item.desc}
                            </div>
                          </div>
                        </SelectableCard>
                      ))}
                    </div>
                  </div>
                )}
              </div>

              <div style={styles.section}>
                <div style={styles.sectionTitle}>æˆ‘çš„ä¼™ä¼´</div>
                
                {pets.map(pet => (
                  <div key={pet.id} style={{
                    display: 'flex', 
                    alignItems: 'center', 
                    gap: '14px', 
                    padding: '16px',
                    background: 'white', 
                    borderRadius: '12px', 
                    marginBottom: '10px',
                    border: '0.5px solid rgba(0,0,0,0.04)'
                  }}>
                    <div style={{
                      fontSize: '24px', 
                      width: '48px', 
                      height: '48px', 
                      background: '#f2f2f7', 
                      borderRadius: '50%', 
                      display: 'flex', 
                      alignItems: 'center', 
                      justifyContent: 'center'
                    }}>
                      {pet.emoji}
                    </div>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontSize: '16px', fontWeight: '600', marginBottom: '2px', color: '#1d1d1f' }}>
                        {pet.name}
                      </div>
                      <div style={{ fontSize: '14px', color: '#86868b' }}>
                        {pet.type} Â· {pet.weight}
                      </div>
                    </div>
                    {pets.length > 1 && (
                      <button 
                        onClick={() => handleRemovePet(pet.id)} 
                        style={{ 
                          background: 'none', 
                          border: 'none', 
                          color: '#ff3b30', 
                          fontSize: '18px',
                          cursor: 'pointer',
                          padding: '6px'
                        }}
                      >
                        Ã—
                      </button>
                    )}
                  </div>
                ))}
                
                <button 
                  onClick={() => setShowAddPet(true)} 
                  style={{
                    ...styles.button,
                    ...styles.buttonSecondary,
                    fontSize: '15px'
                  }}
                >
                  + æ·»åŠ å® ç‰©
                </button>
              </div>

              {savedPlans.length > 0 && (
                <div style={styles.section}>
                  <div style={styles.sectionTitle}>
                    æˆ‘çš„æ”¶è— ({savedPlans.length})
                  </div>
                  <div style={{
                    background: 'white',
                    borderRadius: '12px',
                    padding: '12px',
                    border: '0.5px solid rgba(0,0,0,0.04)'
                  }}>
                    {savedPlans.map((plan, index) => (
                      <div key={plan.id} style={{
                        fontSize: '14px',
                        padding: '8px 0',
                        borderBottom: index < savedPlans.length - 1 ? '0.5px solid rgba(0,0,0,0.05)' : 'none'
                      }}>
                        {plan.title}
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>

            <div style={styles.bottomBar}>
              <button 
                onClick={generatePlans} 
                disabled={!isFormValid} 
                style={{
                  ...styles.button,
                  background: isFormValid ? '#007aff' : '#d1d1d6',
                  color: isFormValid ? 'white' : '#86868b',
                  cursor: isFormValid ? 'pointer' : 'not-allowed'
                }}
              >
                {loading ? (
                  <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'center', gap: '8px' }}>
                    <div className="spin" style={{ 
                      width: '14px', 
                      height: '14px', 
                      border: '2px solid rgba(255,255,255,0.3)', 
                      borderTop: '2px solid white', 
                      borderRadius: '50%' 
                    }}></div>
                    ç”Ÿæˆä¸­...
                  </div>
                ) : (
                  tripType === 'local' ? 'æ™ºèƒ½æ¨è' : 'ç”Ÿæˆè¡Œç¨‹'
                )}
              </button>
            </div>

            {/* æ·»åŠ å® ç‰©æ¨¡æ€æ¡† */}
            {showAddPet && (
              <div style={styles.modal} onClick={(e) => e.target === e.currentTarget && setShowAddPet(false)}>
                <div style={styles.modalContent}>
                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                    <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1d1d1f' }}>æ·»åŠ å® ç‰©</h3>
                    <button 
                      onClick={() => setShowAddPet(false)} 
                      style={{ 
                        background: 'none', 
                        border: 'none', 
                        fontSize: '22px', 
                        color: '#86868b',
                        cursor: 'pointer'
                      }}
                    >
                      Ã—
                    </button>
                  </div>
                  <input 
                    type="text" 
                    placeholder="å® ç‰©åå­—" 
                    value={newPet.name} 
                    onChange={(e) => setNewPet({...newPet, name: e.target.value})} 
                    style={styles.input}
                  />
                  <input 
                    type="text" 
                    placeholder="å“ç§" 
                    value={newPet.type} 
                    onChange={(e) => setNewPet({...newPet, type: e.target.value})} 
                    style={styles.input}
                  />
                  <input 
                    type="text" 
                    placeholder="ä½“é‡" 
                    value={newPet.weight} 
                    onChange={(e) => setNewPet({...newPet, weight: e.target.value})} 
                    style={styles.input}
                  />
                  <button 
                    onClick={handleAddPet} 
                    style={styles.button}
                  >
                    ç¡®è®¤æ·»åŠ 
                  </button>
                </div>
              </div>
            )}

            {/* åŸå¸‚é€‰æ‹©æ¨¡æ€æ¡† */}
            {showCitySelect && <CitySelectModal />}

            {/* ä¿¡ä»»è¯¦æƒ…æ¨¡æ€æ¡† */}
            {showTrustDetails && <TrustDetailsModal />}
          </div>
        );
      }

      if (page === 'plans') {
        const plans = tripType === 'local' ? getLocalPlans() : getTravelPlans();
        
        return (
          <div style={styles.container} className="fade-in">
            <div style={styles.header}>
              <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between' }}>
                <button 
                  onClick={() => setPage('planning')}
                  style={{
                    background: 'none',
                    border: 'none',
                    fontSize: '16px',
                    color: '#007aff',
                    cursor: 'pointer',
                    padding: '4px'
                  }}
                >
                  â€¹ è¿”å›
                </button>
                <div style={{ fontSize: '17px', fontWeight: '600', color: '#1d1d1f' }}>
                  {tripType === 'local' ? 'ä»Šæ—¥æ¨è' : 'è¡Œç¨‹æ–¹æ¡ˆ'}
                </div>
                <button 
                  onClick={() => setShowMapView(true)}
                  style={{
                    background: 'none',
                    border: 'none',
                    fontSize: '20px',
                    cursor: 'pointer',
                    padding: '4px'
                  }}
                >
                  ğŸ—ºï¸
                </button>
              </div>
            </div>

            <div style={styles.content}>
              {tripType === 'local' && (
                <div style={{
                  background: 'linear-gradient(135deg, rgba(48, 209, 88, 0.1), rgba(52, 199, 89, 0.1))',
                  borderRadius: '10px',
                  padding: '14px',
                  marginBottom: '16px',
                  border: '1px solid rgba(48, 209, 88, 0.2)'
                }}>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                    <span style={{ fontSize: '16px' }}>{currentTimeSlot.icon}</span>
                    <div>
                      <div style={{ fontSize: '14px', fontWeight: '600', color: '#1d1d1f' }}>
                        {currentTimeSlot.label}å¥½ï¼Œ{pets[0]?.name || 'æ‚¨çš„å® ç‰©'}ï¼
                      </div>
                      <div style={{ fontSize: '12px', color: '#86868b', marginTop: '2px' }}>
                        æ ¹æ®å½“å‰æ—¶é—´å’Œæ‚¨çš„ä½ç½®ï¼Œä¸ºæ‚¨æ¨èä»¥ä¸‹æ´»åŠ¨
                      </div>
                    </div>
                  </div>
                </div>
              )}

              <div style={{
                background: 'white',
                borderRadius: '12px',
                padding: '12px',
                marginBottom: '16px',
                border: '0.5px solid rgba(0,0,0,0.04)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'space-between'
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '10px' }}>
                  <div style={{
                    width: '32px',
                    height: '32px',
                    background: 'linear-gradient(135deg, #007aff, #5ac8fa)',
                    borderRadius: '50%',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    fontSize: '16px'
                  }}>
                    ğŸ¤–
                  </div>
                  <div>
                    <div style={{ fontSize: '14px', fontWeight: '600', color: '#1d1d1f' }}>
                      FunGo AI æ™ºèƒ½æ¨èå¼•æ“
                    </div>
                    <div style={{ fontSize: '12px', color: '#86868b' }}>
                      {aiAnalyzing ? 'æ­£åœ¨é‡æ–°åˆ†æä¸­...' : 
                       lastAnalysisTime ? `ä¸Šæ¬¡åˆ†æ: ${lastAnalysisTime.toLocaleTimeString()}` : 'å·²å®Œæˆæ™ºèƒ½åˆ†æ'}
                    </div>
                  </div>
                </div>
                <button
                  onClick={triggerAiAnalysis}
                  disabled={aiAnalyzing}
                  style={{
                    background: aiAnalyzing ? '#f2f2f7' : 'rgba(0, 122, 255, 0.1)',
                    color: aiAnalyzing ? '#86868b' : '#007aff',
                    border: 'none',
                    borderRadius: '8px',
                    padding: '8px 12px',
                    fontSize: '12px',
                    fontWeight: '500',
                    cursor: aiAnalyzing ? 'not-allowed' : 'pointer',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '4px'
                  }}
                >
                  {aiAnalyzing ? (
                    <>
                      <div className="spin" style={{ 
                        width: '10px', 
                        height: '10px', 
                        border: '1px solid rgba(134,134,139,0.3)', 
                        borderTop: '1px solid #86868b', 
                        borderRadius: '50%' 
                      }}></div>
                      åˆ†æä¸­
                    </>
                  ) : (
                    <>ğŸ”„ é‡æ–°åˆ†æ</>
                  )}
                </button>
              </div>

              <div style={styles.section}>
                {tripType === 'local' ? (
                  plans.map((plan, index) => (
                    <div key={plan.id} className="slide-in" style={{ animationDelay: `${index * 0.1}s` }}>
                      <LocalPlanCard 
                        plan={plan}
                        isSaved={savedPlans.some(p => p.id === plan.id)}
                        onSave={handleSavePlan}
                        onPreview={(plan) => setCurrentPlan(plan)}
                      />
                    </div>
                  ))
                ) : (
                  plans.map((plan, index) => (
                    <div key={plan.id} className="slide-in" style={{ animationDelay: `${index * 0.1}s` }}>
                      <TravelPlanCard 
                        plan={plan}
                        isSaved={savedPlans.some(p => p.id === plan.id)}
                        onSave={handleSavePlan}
                        onPreview={(plan) => setCurrentPlan(plan)}
                        onBookHotel={(hotel) => {
                          alert(`é¢„è®¢ ${hotel.name}\nä»·æ ¼: Â¥${hotel.price}/æ™š\nå® ç‰©è´¹: Â¥${hotel.petFee}`);
                        }}
                      />
                    </div>
                  ))
                )}
              </div>

              <div style={{ textAlign: 'center', marginTop: '20px' }}>
                <button
                  style={{
                    background: 'none',
                    border: 'none',
                    color: '#007aff',
                    fontSize: '14px',
                    fontWeight: '500',
                    cursor: 'pointer',
                    padding: '8px 16px'
                  }}
                  onClick={() => alert('åŠ è½½æ›´å¤šæ¨è')}
                >
                  æŸ¥çœ‹æ›´å¤š â†’
                </button>
              </div>

              <div style={{
                background: 'rgba(0, 122, 255, 0.05)',
                borderRadius: '10px',
                padding: '12px',
                marginTop: '16px',
                border: '0.5px solid rgba(0, 122, 255, 0.1)'
              }}>
                <div style={{ fontSize: '12px', fontWeight: '600', color: '#007aff', marginBottom: '6px' }}>
                  ğŸ“Š æ¨èç®—æ³•é€æ˜åº¦
                </div>
                <div style={{ fontSize: '11px', color: '#86868b', lineHeight: '1.4' }}>
                  æˆ‘ä»¬çš„æ¨èåŸºäºå¤šç»´åº¦æ•°æ®ï¼šå¤–éƒ¨å¹³å°ç”¨æˆ·è¯„ä»·(75%)ã€FunGoå‘˜å·¥å®åœ°è¸©ç‚¹(15%)ã€ç”¨æˆ·åé¦ˆ(10%)ã€‚
                  æ‰€æœ‰æ•°æ®å®æ—¶æ›´æ–°ï¼Œç¡®ä¿æ¨èçš„å‡†ç¡®æ€§å’Œæ—¶æ•ˆæ€§ã€‚
                </div>
                <div style={{ marginTop: '8px', display: 'flex', alignItems: 'center', gap: '8px' }}>
                  <button
                    onClick={() => setShowTrustDetails(true)}
                    style={{
                      background: 'rgba(0, 122, 255, 0.1)',
                      color: '#007aff',
                      border: 'none',
                      borderRadius: '6px',
                      padding: '4px 8px',
                      fontSize: '10px',
                      fontWeight: '500',
                      cursor: 'pointer'
                    }}
                  >
                    æŸ¥çœ‹è¯¦ç»†ä¿éšœä½“ç³»
                  </button>
                  <div style={{ fontSize: '10px', color: '#30d158' }}>
                    ğŸŸ¢ å®æ—¶ç›‘æ§ä¸­ Â· æœ€åæ›´æ–°: {realTimeData.lastUpdate.toLocaleTimeString()}
                  </div>
                </div>
              </div>
            </div>

            <div style={styles.bottomBar}>
              <div style={{ 
                display: 'flex', 
                alignItems: 'center', 
                justifyContent: 'space-between',
                fontSize: '14px'
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                  <div style={{ color: '#86868b' }}>
                    å·²æ”¶è— {savedPlans.length} ä¸ªæ–¹æ¡ˆ
                  </div>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '4px', fontSize: '12px', color: '#007aff' }}>
                    <span>ğŸ¤–</span>
                    <span>AIæ¨è</span>
                  </div>
                  <div style={{ display: 'flex', alignItems: 'center', gap: '4px', fontSize: '12px', color: '#30d158' }}>
                    <span>ğŸ›¡ï¸</span>
                    <span>ä¿¡ä»»ä¿éšœ</span>
                  </div>
                </div>
                {savedPlans.length > 0 && (
                  <button
                    onClick={() => {
                      alert(`å·²æ”¶è—çš„æ–¹æ¡ˆ:\n${savedPlans.map(p => p.title).join('\n')}`);
                    }}
                    style={{
                      background: '#007aff',
                      color: 'white',
                      border: 'none',
                      borderRadius: '8px',
                      padding: '8px 16px',
                      fontSize: '14px',
                      fontWeight: '500',
                      cursor: 'pointer'
                    }}
                  >
                    æŸ¥çœ‹æ”¶è—
                  </button>
                )}
              </div>
            </div>

            {/* é¢„è§ˆæ¨¡æ€æ¡† */}
            {currentPlan && (
              <PlanPreview 
                plan={currentPlan}
                onClose={() => setCurrentPlan(null)}
                onSave={handleSavePlan}
                isSaved={savedPlans.some(p => p.id === currentPlan.id)}
              />
            )}

            {/* åœ°å›¾è§†å›¾ */}
            {showMapView && (
              <MapView 
                places={tripType === 'local' ? plans.map(p => p.place) : plans[0]?.places}
                onClose={() => setShowMapView(false)}
              />
            )}

            {/* ä¿¡ä»»è¯¦æƒ…æ¨¡æ€æ¡† */}
            {showTrustDetails && <TrustDetailsModal />}
          </div>
        );
      }

      return null;
    };

    // æ¸²æŸ“åº”ç”¨
    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
