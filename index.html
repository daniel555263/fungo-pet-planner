<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FunGo 宠物旅行规划器</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
    }
    
    body { 
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "PingFang SC", "Microsoft YaHei", sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #2d3436;
    }
    
    @keyframes slideIn { 
      from { opacity: 0; transform: translateY(20px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    
    @keyframes pulse { 
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.8; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    .slide-in { animation: slideIn 0.5s ease-out; }
    .pulse { animation: pulse 2s ease-in-out infinite; }
    .fade-in { animation: fadeIn 0.3s ease-out; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect, useMemo } = React;

    // 智能时段推荐系统
    const getTimeBasedRecommendations = () => {
      const hour = new Date().getHours();
      
      if (hour >= 6 && hour < 10) {
        return {
          period: '早晨',
          emoji: '🌅',
          activities: ['晨跑公园', '宠物早餐店', '湖边散步'],
          highlight: '清晨空气清新，适合运动'
        };
      } else if (hour >= 10 && hour < 14) {
        return {
          period: '上午',
          emoji: '☀️',
          activities: ['宠物游乐园', '室内活动中心', '宠物美容'],
          highlight: '阳光充足，注意防晒'
        };
      } else if (hour >= 14 && hour < 17) {
        return {
          period: '下午',
          emoji: '🌤️',
          activities: ['宠物咖啡厅', '购物中心', '室内游戏'],
          highlight: '避开最热时段，室内活动为主'
        };
      } else if (hour >= 17 && hour < 20) {
        return {
          period: '傍晚',
          emoji: '🌆',
          activities: ['海边漫步', '宠物公园', '户外晚餐'],
          highlight: '黄金遛狗时间，温度适宜'
        };
      } else {
        return {
          period: '夜晚',
          emoji: '🌙',
          activities: ['宠物友好餐厅', '夜市遛弯', '星空露营'],
          highlight: '凉爽舒适，注意安全'
        };
      }
    };

    // 生成智能推荐方案
    const generateSmartPlans = (tripType, preferences, city, duration) => {
      const timeRec = getTimeBasedRecommendations();
      
      if (tripType === 'local') {
        // 本地游方案 - 基于当前时段
        return [
          {
            id: 1,
            title: `${timeRec.period}限定体验`,
            subtitle: timeRec.highlight,
            emoji: timeRec.emoji,
            type: 'time-based',
            highlights: ['实时推荐', '当季最佳', '宠物专属'],
            petActivities: timeRec.activities,
            duration: '2-3小时',
            petFriendly: 5,
            price: '💰💰',
            tags: ['即刻出发', '宠物游乐', '拍照打卡']
          },
          {
            id: 2,
            title: '周末休闲套餐',
            subtitle: '轻松惬意的亲子时光',
            emoji: '🎪',
            type: 'leisure',
            highlights: ['宠物乐园', '美食探店', '专属摄影'],
            petActivities: ['狗狗游泳池', '宠物运动场', '社交派对'],
            duration: '半天',
            petFriendly: 5,
            price: '💰💰💰',
            tags: ['社交', '运动', '美食']
          },
          {
            id: 3,
            title: '探索城市秘境',
            subtitle: '发现城市里的宠物天堂',
            emoji: '🗺️',
            type: 'explore',
            highlights: ['小众景点', '自然风光', '私密空间'],
            petActivities: ['秘密花园', '私人海滩', '山林徒步'],
            duration: '全天',
            petFriendly: 4,
            price: '💰',
            tags: ['探险', '自然', '私密']
          }
        ];
      } else {
        // 长途游方案 - 基于行程类型
        return [
          {
            id: 1,
            title: '舒适度假型',
            subtitle: '宠物友好度假村体验',
            emoji: '🏖️',
            type: 'resort',
            highlights: ['五星酒店', '私人沙滩', '管家服务'],
            accommodation: '宠物度假村',
            transport: '商务车接送',
            duration: duration,
            petFriendly: 5,
            price: '💰💰💰💰💰',
            tags: ['奢华', '全包', '省心']
          },
          {
            id: 2,
            title: '自驾探索型',
            subtitle: '灵活自由的公路旅行',
            emoji: '🚗',
            type: 'roadtrip',
            highlights: ['随心停留', '景点丰富', '宠物友好'],
            accommodation: '特色民宿',
            transport: '自驾/租车',
            duration: duration,
            petFriendly: 4,
            price: '💰💰💰',
            tags: ['自由', '探索', '灵活']
          },
          {
            id: 3,
            title: '文化体验型',
            subtitle: '深度感受当地风情',
            emoji: '🏛️',
            type: 'cultural',
            highlights: ['古镇漫步', '美食之旅', '民俗体验'],
            accommodation: '精品客栈',
            transport: '高铁+当地交通',
            duration: duration,
            petFriendly: 3,
            price: '💰💰',
            tags: ['文化', '美食', '慢游']
          }
        ];
      }
    };

    const App = () => {
      const [page, setPage] = useState('planning');
      const [tripType, setTripType] = useState('');
      const [selectedCity, setSelectedCity] = useState('深圳');
      const [selectedDistrict, setSelectedDistrict] = useState('南山区');
      const [duration, setDuration] = useState('');
      const [pets, setPets] = useState([{ 
        id: 1, name: '旺财', type: '金毛', emoji: '🐕', weight: '25kg' 
      }]);
      const [preferences, setPreferences] = useState([]);
      const [generatedPlans, setGeneratedPlans] = useState([]);
      const [selectedPlan, setSelectedPlan] = useState(null);
      const [preservedPlans, setPreservedPlans] = useState([]);
      
      // UI 状态
      const [showAddPet, setShowAddPet] = useState(false);
      const [loading, setLoading] = useState(false);
      const [newPet, setNewPet] = useState({ name: '', type: '', weight: '' });

      // 配置数据
      const interests = [
        { id: 'beach', label: '海边玩水', icon: '🏖️', color: '#4ECDC4' },
        { id: 'run', label: '自由奔跑', icon: '🏃', color: '#95E1D3' },
        { id: 'cafe', label: '咖啡时光', icon: '☕', color: '#F3A683' },
        { id: 'park', label: '公园散步', icon: '🌳', color: '#78E08F' },
        { id: 'photo', label: '拍照打卡', icon: '📸', color: '#FDA7DF' },
        { id: 'food', label: '美食探店', icon: '🍽️', color: '#FAB1A0' }
      ];

      const generateTrips = () => {
        if (!tripType) return;
        setLoading(true);
        setTimeout(() => {
          const plans = generateSmartPlans(tripType, preferences, selectedCity, duration);
          setGeneratedPlans(plans);
          setLoading(false);
          setPage('plans');
        }, 1500);
      };

      const selectPlan = (plan) => {
        setSelectedPlan(plan);
        setPage('details');
      };

      const togglePreservePlan = (planId) => {
        setPreservedPlans(prev => 
          prev.includes(planId) 
            ? prev.filter(id => id !== planId)
            : [...prev, planId]
        );
      };

      // 规划页面
      if (page === 'planning') {
        return (
          <div style={{ 
            minHeight: '100vh',
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
            paddingBottom: '100px'
          }}>
            {/* 优化的头部 */}
            <div style={{ 
              background: 'rgba(255, 255, 255, 0.95)', 
              backdropFilter: 'blur(10px)',
              padding: '20px',
              boxShadow: '0 2px 20px rgba(0,0,0,0.1)'
            }}>
              <div style={{ 
                fontSize: '36px', 
                fontWeight: '800', 
                textAlign: 'center',
                background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                WebkitBackgroundClip: 'text',
                WebkitTextFillColor: 'transparent',
                marginBottom: '8px'
              }}>
                FunGo
              </div>
              <div style={{ 
                fontSize: '14px', 
                color: '#8b95a5', 
                textAlign: 'center',
                letterSpacing: '0.5px'
              }}>
                🐾 和毛孩子一起探索世界
              </div>
            </div>

            <div style={{ padding: '24px' }}>
              {/* 出行类型选择 - 优化的卡片 */}
              <div className="slide-in" style={{ marginBottom: '32px' }}>
                <div style={{ 
                  fontSize: '18px', 
                  fontWeight: '600', 
                  color: 'white',
                  marginBottom: '16px',
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px'
                }}>
                  <span style={{ 
                    background: 'rgba(255,255,255,0.2)', 
                    borderRadius: '50%', 
                    width: '28px', 
                    height: '28px',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'center',
                    fontSize: '14px',
                    fontWeight: '700'
                  }}>1</span>
                  选择出行方式
                </div>
                
                <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px' }}>
                  {[
                    { type: 'local', icon: '🏠', label: '本地游', desc: '2-8小时' },
                    { type: 'travel', icon: '✈️', label: '长途游', desc: '1-7天' }
                  ].map(item => (
                    <div 
                      key={item.type}
                      onClick={() => setTripType(item.type)}
                      style={{
                        background: tripType === item.type 
                          ? 'rgba(255,255,255,0.95)' 
                          : 'rgba(255,255,255,0.85)',
                        borderRadius: '20px',
                        padding: '24px',
                        cursor: 'pointer',
                        transition: 'all 0.3s ease',
                        transform: tripType === item.type ? 'scale(1.02)' : 'scale(1)',
                        boxShadow: tripType === item.type 
                          ? '0 10px 30px rgba(0,0,0,0.2)' 
                          : '0 4px 15px rgba(0,0,0,0.1)',
                        border: tripType === item.type 
                          ? '2px solid #667eea'
                          : '2px solid transparent'
                      }}
                    >
                      <div style={{ fontSize: '40px', marginBottom: '12px', textAlign: 'center' }}>
                        {item.icon}
                      </div>
                      <div style={{ 
                        fontSize: '18px', 
                        fontWeight: '600', 
                        color: '#2d3436',
                        textAlign: 'center',
                        marginBottom: '4px'
                      }}>
                        {item.label}
                      </div>
                      <div style={{ 
                        fontSize: '12px', 
                        color: '#95a5a6',
                        textAlign: 'center'
                      }}>
                        {item.desc}
                      </div>
                    </div>
                  ))}
                </div>
              </div>

              {/* 位置信息 - 优化的对齐和布局 */}
              {tripType && (
                <div className="slide-in" style={{ marginBottom: '32px' }}>
                  <div style={{ 
                    fontSize: '18px', 
                    fontWeight: '600', 
                    color: 'white',
                    marginBottom: '16px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px'
                  }}>
                    <span style={{ 
                      background: 'rgba(255,255,255,0.2)', 
                      borderRadius: '50%', 
                      width: '28px', 
                      height: '28px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      fontSize: '14px',
                      fontWeight: '700'
                    }}>2</span>
                    {tripType === 'local' ? '确认所在位置' : '选择目的地'}
                  </div>
                  
                  <div style={{
                    background: 'white',
                    borderRadius: '20px',
                    padding: '20px',
                    boxShadow: '0 4px 15px rgba(0,0,0,0.1)',
                    display: 'flex',
                    alignItems: 'center',
                    justifyContent: 'space-between'
                  }}>
                    <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                      <div style={{
                        width: '48px',
                        height: '48px',
                        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                        borderRadius: '12px',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        fontSize: '24px'
                      }}>
                        📍
                      </div>
                      <div>
                        <div style={{ fontSize: '18px', fontWeight: '600', color: '#2d3436' }}>
                          {selectedCity} · {selectedDistrict}
                        </div>
                        <div style={{ fontSize: '13px', color: '#95a5a6', marginTop: '4px' }}>
                          ☀️ 28°C 适宜出行
                        </div>
                      </div>
                    </div>
                    <div className="pulse" style={{
                      width: '10px',
                      height: '10px',
                      background: '#27ae60',
                      borderRadius: '50%'
                    }}></div>
                  </div>
                </div>
              )}

              {/* 偏好选择 - 优化的网格布局 */}
              {tripType && (
                <div className="slide-in" style={{ marginBottom: '32px' }}>
                  <div style={{ 
                    fontSize: '18px', 
                    fontWeight: '600', 
                    color: 'white',
                    marginBottom: '16px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px'
                  }}>
                    <span style={{ 
                      background: 'rgba(255,255,255,0.2)', 
                      borderRadius: '50%', 
                      width: '28px', 
                      height: '28px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      fontSize: '14px',
                      fontWeight: '700'
                    }}>3</span>
                    想要什么样的体验？
                  </div>
                  
                  <div style={{ 
                    display: 'grid', 
                    gridTemplateColumns: 'repeat(3, 1fr)', 
                    gap: '12px'
                  }}>
                    {interests.map(item => (
                      <div 
                        key={item.id}
                        onClick={() => {
                          setPreferences(prev => 
                            prev.includes(item.label) 
                              ? prev.filter(p => p !== item.label)
                              : [...prev, item.label]
                          );
                        }}
                        style={{
                          background: preferences.includes(item.label) 
                            ? item.color 
                            : 'rgba(255,255,255,0.9)',
                          borderRadius: '16px',
                          padding: '16px',
                          cursor: 'pointer',
                          transition: 'all 0.3s ease',
                          transform: preferences.includes(item.label) ? 'scale(0.95)' : 'scale(1)',
                          border: '2px solid transparent'
                        }}
                      >
                        <div style={{ 
                          fontSize: '28px', 
                          marginBottom: '8px',
                          textAlign: 'center'
                        }}>
                          {item.icon}
                        </div>
                        <div style={{ 
                          fontSize: '12px', 
                          fontWeight: '500',
                          color: preferences.includes(item.label) ? 'white' : '#2d3436',
                          textAlign: 'center'
                        }}>
                          {item.label}
                        </div>
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {/* 宠物信息 */}
              {tripType && (
                <div className="slide-in" style={{ marginBottom: '32px' }}>
                  <div style={{ 
                    fontSize: '18px', 
                    fontWeight: '600', 
                    color: 'white',
                    marginBottom: '16px',
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px'
                  }}>
                    <span style={{ 
                      background: 'rgba(255,255,255,0.2)', 
                      borderRadius: '50%', 
                      width: '28px', 
                      height: '28px',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      fontSize: '14px',
                      fontWeight: '700'
                    }}>4</span>
                    同行伙伴
                  </div>
                  
                  {pets.map(pet => (
                    <div key={pet.id} style={{
                      background: 'white',
                      borderRadius: '16px',
                      padding: '16px',
                      marginBottom: '12px',
                      display: 'flex',
                      alignItems: 'center',
                      gap: '16px',
                      boxShadow: '0 2px 10px rgba(0,0,0,0.1)'
                    }}>
                      <div style={{
                        width: '56px',
                        height: '56px',
                        background: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)',
                        borderRadius: '50%',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        fontSize: '28px'
                      }}>
                        {pet.emoji}
                      </div>
                      <div style={{ flex: 1 }}>
                        <div style={{ fontSize: '16px', fontWeight: '600', color: '#2d3436' }}>
                          {pet.name}
                        </div>
                        <div style={{ fontSize: '14px', color: '#95a5a6' }}>
                          {pet.type} · {pet.weight}
                        </div>
                      </div>
                    </div>
                  ))}
                  
                  <button
                    onClick={() => setShowAddPet(true)}
                    style={{
                      width: '100%',
                      padding: '16px',
                      background: 'rgba(255,255,255,0.3)',
                      border: '2px dashed rgba(255,255,255,0.6)',
                      borderRadius: '16px',
                      color: 'white',
                      fontSize: '16px',
                      fontWeight: '500',
                      cursor: 'pointer',
                      transition: 'all 0.3s ease'
                    }}
                  >
                    + 添加宠物
                  </button>
                </div>
              )}
            </div>

            {/* 底部按钮 */}
            {tripType && (
              <div style={{
                position: 'fixed',
                bottom: 0,
                left: 0,
                right: 0,
                padding: '20px',
                background: 'rgba(255,255,255,0.95)',
                backdropFilter: 'blur(10px)',
                boxShadow: '0 -2px 20px rgba(0,0,0,0.1)'
              }}>
                <button
                  onClick={generateTrips}
                  disabled={loading}
                  style={{
                    width: '100%',
                    padding: '18px',
                    background: loading 
                      ? '#95a5a6'
                      : 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                    border: 'none',
                    borderRadius: '16px',
                    color: 'white',
                    fontSize: '18px',
                    fontWeight: '600',
                    cursor: loading ? 'not-allowed' : 'pointer',
                    transition: 'all 0.3s ease'
                  }}
                >
                  {loading ? '生成中...' : '智能生成方案'}
                </button>
              </div>
            )}

            {/* 添加宠物弹窗 */}
            {showAddPet && (
              <div style={{
                position: 'fixed',
                top: 0,
                left: 0,
                right: 0,
                bottom: 0,
                background: 'rgba(0,0,0,0.5)',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                padding: '20px',
                zIndex: 1000
              }}>
                <div style={{
                  background: 'white',
                  borderRadius: '24px',
                  padding: '24px',
                  width: '100%',
                  maxWidth: '400px'
                }}>
                  <h3 style={{ marginBottom: '20px', color: '#2d3436' }}>添加宠物</h3>
                  <input
                    type="text"
                    placeholder="宠物名字"
                    value={newPet.name}
                    onChange={(e) => setNewPet({...newPet, name: e.target.value})}
                    style={{
                      width: '100%',
                      padding: '14px',
                      border: '1px solid #dfe6e9',
                      borderRadius: '12px',
                      marginBottom: '12px',
                      fontSize: '16px'
                    }}
                  />
                  <input
                    type="text"
                    placeholder="品种"
                    value={newPet.type}
                    onChange={(e) => setNewPet({...newPet, type: e.target.value})}
                    style={{
                      width: '100%',
                      padding: '14px',
                      border: '1px solid #dfe6e9',
                      borderRadius: '12px',
                      marginBottom: '12px',
                      fontSize: '16px'
                    }}
                  />
                  <input
                    type="text"
                    placeholder="体重"
                    value={newPet.weight}
                    onChange={(e) => setNewPet({...newPet, weight: e.target.value})}
                    style={{
                      width: '100%',
                      padding: '14px',
                      border: '1px solid #dfe6e9',
                      borderRadius: '12px',
                      marginBottom: '20px',
                      fontSize: '16px'
                    }}
                  />
                  <div style={{ display: 'flex', gap: '12px' }}>
                    <button
                      onClick={() => setShowAddPet(false)}
                      style={{
                        flex: 1,
                        padding: '14px',
                        background: '#f1f3f5',
                        border: 'none',
                        borderRadius: '12px',
                        fontSize: '16px',
                        cursor: 'pointer'
                      }}
                    >
                      取消
                    </button>
                    <button
                      onClick={() => {
                        if (newPet.name && newPet.type && newPet.weight) {
                          setPets([...pets, { ...newPet, id: Date.now(), emoji: '🐕' }]);
                          setNewPet({ name: '', type: '', weight: '' });
                          setShowAddPet(false);
                        }
                      }}
                      style={{
                        flex: 1,
                        padding: '14px',
                        background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
                        border: 'none',
                        borderRadius: '12px',
                        color: 'white',
                        fontSize: '16px',
                        fontWeight: '600',
                        cursor: 'pointer'
                      }}
                    >
                      确认
                    </button>
                  </div>
                </div>
              </div>
            )}
          </div>
        );
      }

      // 方案选择页面
      if (page === 'plans') {
        const timeRec = getTimeBasedRecommendations();
        
        return (
          <div style={{ 
            minHeight: '100vh',
            background: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
          }}>
            <div style={{ 
              background: 'rgba(255,255,255,0.95)', 
              backdropFilter: 'blur(10px)',
              padding: '20px',
              boxShadow: '0 2px 20px rgba(0,0,0,0.1)'
            }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                <button
                  onClick={() => setPage('planning')}
                  style={{
                    background: 'none',
                    border: 'none',
                    fontSize: '24px',
                    cursor: 'pointer'
                  }}
                >
                  ←
                </button>
                <div style={{ flex: 1 }}>
                  <div style={{ fontSize: '20px', fontWeight: '700', color: '#2d3436' }}>
                    为您智能推荐
                  </div>
                  <div style={{ fontSize: '14px', color: '#95a5a6', marginTop: '4px' }}>
                    {tripType === 'local' 
                      ? `基于${timeRec.period}时段 · ${selectedCity}` 
                      : `${selectedCity}之旅 · ${duration}天行程`}
